デジタル信号I理第１回vxY料 （ガイダンス、デジタルとは）立命^大学 情罄砉ぱР  メディア情笱Э 李  亮２０１６．９．２２vxの前にデジタル信号I理について?  概要：? 信号波形をコンピュ`タを使ってデジタルI理するため の基本的な概念、理、アルゴリズムを理解することを 目摔摔く?  キ`ワ`ド? アナログ信号?x散rg信号?デジタル信号? ADQ、サンプリング定理? フ`リエQ、  FFT? x散rg信号系、形、r不? ｚQ、逆ｚQ? デジタルフィルタ、贿_v数参考について参考ディジタル信号I理の基A 宇津m、兼田   著  （森北出版） ISBN: 4-627-78311-6?1,800- + 税参考ユ`ザ`ズディジタル信号I理?  江原x郎  著（|京C大学出版局）?  ISBN: 4-501-31420-6?  ?2,600- + 税vxを通じて信号をQうので数式が非常に多い?   }素数、数、e分など?   できるだけ式と恧阌盲筏圃しくh明しますが、最K的 には式の意味を概念的に理解するように? 高校の物理や数学が理解できないとvxについてくるのはyしい? 数学が苦手な学生は必ず高校の数学を土しておくように演n}? vx中にたくさんの演n}を出しますので、Bって解いてみ てください。模解答はその訾切肖い蓼埂￥长}が解ければ 期末Yも合格点が取れると思います。他科目とのvB性?   メディア情笱Э疲夯像情I理、音声音情I理など?   知能情笱Э疲亥互螗伐螗肮ぱГ胜芍vxの注意点デジタル信号I理は工学の基Aとなる科目?   vxの例}は音信号を中心にしてh明? 特に身近な音C器を例に取りh明する予定? 画像I理にd味がある学生は画像信号? 生体I理などにd味がある学生は心恧涿波信号にお きかえて理解するようにg位取得条件?   期末Y  ７０点?   平常点  ３０点vxスケジュ`ル（予定）第1回  ガイダンス、アナログ、デジタルとは第２回  x散rg信号 、フ`リエQ（周波数解析） 第３回  スペクトル`差、v数第４回  x散rg信号系、  zQ 第５回  デジタルフィルタ１第６回  デジタルフィルタ２ 第７回  まとめ第８回  10月11日（火）   期末Y1デジタルとはF在、身の回りの化u品はほとんどデジタル化さ れつつある?   身近なデジタル家? 携‰：   アナログ   ?  デジタル? テレビ放送：   アナログ  ?  デジタル? ビデオレコ`ダ：  アナログ（VHS） ?  デジタル（DVD, HDD）? 音S配信：   アナログ（レコ`ド）  ?  デジタル（CD, ネット配信）?   では、デジタルとはどういうことなのか？? 纠搐违ナログとは何が`うのか？デジタルとアナログアナログ：  analog  (日本ZUは似とか相似)?     情蠓忠挨扦稀高BA量」をさす?     自然界の量デジタル:   digital (Z源はdigit  日本ZUはアラビア数字)?     情蠓忠挨扦稀鸽x散量」をさす?     BA量をx散的に数化したもの?     さらにその数を「０」と「１」で表すデジタルの利点デジタルだと何が良いのか？?   すべてを数字で表F可能? ?  コンピュ`タでQえる  （集?加工がg）? ?  情罅郡蛳pできる  （情罄碚で学予定）? ?  高品|で保存可能  （外界からのj音にい）?   音分野でのデジタル? ＣＭでデジタルだから高音|という表Fがある?   でも本当に音が良いのはアナログ?   なぜなら我々が耳でく音はアナログだから?   耳で波を感知しており、耳で数字を感知していない?   またアナログ信号をデジタル信号にQすると必ず音|は劣化する?   ただしデジタルはすべてを数字で表F可能なのでj音にい?   よってh音した音を10年後いてみると、保存状Bによってはデジタル の方が明らかに音が良い演n}（1/2）これってデジタル？?  rgの流れ?  ]便料金?  将棋のxの婴?  ヒント：デジタルとアナログは何が`うのか？演n}（1/2）  解答例これってデジタル？?   rgの流れ? アナログ：   理由はrgの流れはBAだから。もしデジタルだ とrの流れがwびwびになる。?   ]便料金? デジタル：   重さや大きさの具体的な数（x散量）によって 料金がQまっているから。?   将棋のxの婴? デジタル：   ますめで区切られた空g（x散空g）しか婴堡 い。BA的に婴と将棋にならない。デジタル信号I理の意味は？デジタル信号I理?   デジタル：  数字列?   信号I理：  入力系列の加工?集?解析?   ?  数字列の加工?集?解析を行う? よってvxで学する内容は音分野に限らずデジタル 信号（数字列）をQう分野すべてで暧每赡?   数字列の加工?集?解析を行うために? 形代数、微分?e分などは必要不可欠? 特に周波数（スペクトル）をQうHには}素数の概念が必要?   本vxでは、? 信号の入口（アナログ）から集?加工（デジタル）を通じて 信号の出口（アナログ）までを包括的に学予定2演n}（2/2）日常生活のなかで、デジタル化してほしいものを３ つあげよ。（理由もdのこと、最低1つ以上くこと）?     例：植物の水遣り：   店TにQ~植物にいつ水を遣れば良いですか？とく と「土の表面が乾いてきたら水をたっぷりと」という答えが返ってきます。素 人にはまったくわかりません。これを「土の表面の含水量が○ml/mm ２以下 になれば水を○リットルかけてくださいといってもらえれば非常にわかりや すい。?   ヒント：デジタル化のポイントは？? アイディアによってはビジネスチャンスにつながるかも？演n}（2/2）  解答例日常生活のなかで、デジタル化してほしいもの を３つあげよ。（理由もdのこと、最低1つ以上くこと）?  考え方「デジタル化のポイントは」?  数で表すことにmしたもの?  数で表したほうがm切に贿_できるもの?  例を参考に自分自身で色々考えてみること3デジタル信号I理第２回vxY料 （アナログからデジタルへ）立命^大学 情罄砉ぱР  メディア情笱Э 李  亮２０１６．９．２２今回のvx内容アナログ信号とデジタル信号の`い?   前回学したアナログとデジタルの考え方をもとに、 信号としてどのようにQうのかをvxアナログ信号からデジタル信号にQ?   どうやってQするのか？?   Q後の信号はどうなるの？【土】アナログとデジタルコンピュ`タでデ`タQう龊膝ナログ  ＝  BA量?   区切って数えられない? 我々がアナログ量を理 解するときは^の中で デジタルにQアナログ                            デジタルデジタル量のデ`タ： キ`ボ`ドなどからgに入力可能                 アナログ量のデ`タ： そのまま入力することは不可能デジタル  ＝  x散量?   区切って数えられる?   有限の数列デジタルコンピュ`タ               アナログ波形                                   デジタルコンピュ`タアナログ信号をコンピュ`タでQうためには?  アナログ信号をデジタル信号にQする必要がある（これをＡＤQ(Analog-Digital Conversion)という）デジタル信号I理系ADQの概要アナログ信号アナログ信号 Ｄ／ＡQ      Ａ／ＤQデジタル信号BA量の信号アナログ  ?  デジタルQ x散量の信号この部分を 大する。吮净1,  3,  6,  9,  10,  8, …量子化デジタル コンピュ`タデジタル信号I理信号を加工rg（秒）(a)   アナログ信号（rgもRもBA量）吮净g隔(b) 吮净後の信号（秒）（秒）(c) 量子化後の信号（rgも振幅もx散量）情                      他のデジタル信号を利用可能（rgはx散量、振幅はBA量）1吮净とは吮净(サンプリング)?     あるrgg隔で信号を取り出す こと?     BArg（アナログ）をx散rg（デジタル）にQ(a) 源信号0                                      5                                          10 (秒)(b) 1秒g隔で 吮净0                                      5                                          10 (秒)(c) 0.5秒g隔 で吮净演n}（1/4）下恧尾à吮净してx散rg信号にQしたい。?   8Hzで吮净したときの吮镜悚碇肖恕瘠鞘兢弧?   同に2Hzで吮净したときの吮镜悚碇肖恕黏鞘兢弧?     吮净g隔       秒?     吮净周波数     Hz?     吮净周波数が高い（吮净g 隔が狭い）ほど忠gに信号を表 F可能0                                      5                                          10 (秒)0                                      5                                          10 (秒)(d) 0.25秒g隔 で吮净?ヒント：?sin(2*π*3*t+π)1.000.00吮净の例虫の泣き声を下の周波数で吮净すると?     例：  音SＣＤの吮净周波数は ?22050Hzで吮净?8Hzで吮净すると吮净g隔は？44100Hz?10000Hzで吮净?8000Hzで吮净 吮净周波数を高くO定すると忠gに音を表F可能-1.000.00                                                 0.50                                                 1.001.00演n}（1/4）  解答例下恧尾à吮净してx散rg信号にQしたい。?   8Hzで吮净したときの吮镜悚碇肖恕瘠鞘兢弧?   同に2Hzで吮净したときの吮镜悚碇肖恕黏鞘兢弧1.00量子化とは量子化                         振幅?     振幅をデジタル量にQする こと?     振幅（アナログ）をデジタル量（デジタル）にQ8段Aに量子化した龊 量子化`差rg0.00-1.000.00                                           0.50                                           1.008Hzで吮净0.00-1.000.00                                           0.50                                           1.002Hzで吮净?     量子化：   振幅の解像度?     量子化ビット数が大きいほど 忠gに信号を表F可能?     逆に量子化ビット数が小さいと 量子化`差がす?     例：  音SＣＤの量子化ビット 数は１６ bits16（2 : -32768 ～  32767までBAした赤い上の振幅（青い点） を８段Aにした（v色の点）の中で近 いほうのを\丸のrgにおけると するよって各r刻における真（x散rg信号） と量子化（デジタル信号）には量子化`差 が生じる等g隔で吮净するのがポイントの65536段A）演n}（2/4）演n}（2/4） 解答例1.000.00-1.000.00                                                  0.50                                                  1.00演n}(1/4)でQした吮净周波数8Hzのx散rg信 号をデジタル信号にQしたい。下の大きさで量子化する とどうなるか硎兢护琛?     振幅を４の（２ビット）で量子化する龊?     振幅を９（３ビット～４ビット）ので量子化する龊涎萘n}(1/4)でQした吮净周波数8Hzのx散rg信号をデジタル信号にQ したい。下の大きさで量子化するとどうなるか硎兢护琛?           振幅を４の（２bits）で量子化する龊?           振幅を９の（３から４bits）で量子化する龊?     ポイント：  各x散rg信号の振幅（アナログ）を量子化するときは、真 から最も近い点に量子化する。1.001.001.00例：  吮净周波数2Hzのx散r g信号を３つので量子化すると0.000.000.001.000.00-1.000.00                                           0.50                                           1.00-1.000.00                                           0.50                                           1.00-1.000.00                                                 0.50                                                 1.00-1.000.00                                                     0.50                                                     1.00４ので量子化（３等分）９ので量子化（８等分）2ADQのまとめアナログ信号アナログ信号I理とデジタル信号I理の比^この部分を 大する。1,  3,  6,  9,  10,  8, …デジタル コンピュ`タ吮净                                                         量子化rg（秒）(a)   アナログ信号（rgもRもBA量）吮净g隔(b) 吮净後の信号（秒）(C) 量子化後の信号（秒）（rgはx散量、振幅はBA量）（rgも振幅もx散量）アナログ信号            x散rg信号            デジタル信号ADQにおける注意点吮净周波数?   高いほど忠gに信号を再F可能であるがデ`タ量は大?   音信号で考えると吮净周波数が低いと音は低くなる。（高音がなくなってしまう。）?  吮净rに吮净定理を氦郡贡匾がある量子化ビット数?   大きいほど`差は小さくなるがデ`タ量は大?   音信号で考えると量子化`差は音の歪に影する。?  量子化`差を把握しておく必要がある吮净定理（シャノンの吮净定理）吮净周波数をQめる１つの目安 アナログ信号の持つ最高の周波数が    Hzであるとき吮净周波数    は    の２倍以上にO定: ナイキスト吮净周波数?   例：  信号の最高周波数が200Hzの龊稀吮净は400Hz以上の周波数でADQ?  もしナイキスト吮净周波数以下で吮净するとエイリアシング（波の重なりもしくは波の折り返しという意味）がk生1.00エイリアシングの例1.00sin(2*π*t)sin(2*π*3*t+π)エイリアシング例1                                                                                         10.000.001Hzの正弦波3Hzの正弦波             0                                                                                         0-1.00-1.000.00                                                0.50                                                1.00   0.00                                                 0.50                                                 1.001２つの信号を吮净周波数４Hz(吮净g隔0.25秒）で吮净すると２つの信号は重なってえる。0                                                                                              デジタル信号ではこの２つの信号は同じと判断-1                                                                                        -10                                        0.5                                        1   0                                        0.5                                        14Hzで吮净                                 8Hzで吮净エイリアシングの例：-10                                        0.5                                        1?  高い周波数は低い周波数にえる?  必ずナイキスト吮净周波数以上で吮净この龊悉坤6Hz以上で吮净する必要あり吮净周波数が4Hzだとデジタル信号上では波 が完全に重なる（同一信号）が、８Hzだと２つの 信号はデジタル信号としてなる信号となる。8000Hzの音を下の周波数で吮净すると?16000Hzで吮净?12000Hzで吮净?8000Hzで吮净 ナイキスト吮净周波数を氦郡丹胜い纫簸 吮净周波数に辘袱频亭なる3演n}(3/4)演n}(3/4)解答例a足： 一般的にはナイキスト吮净周波数ぎりぎりで 本化することはありません。波の性|から吮净 周波数が高ければ高いほど`差は小さくなります ので、必ずナイキスト吮净周波数＋αの周波数 で吮净します。下恧危菠膜尾àADQするためには何Hz以上の周波 数で吮净すればコンピュ`タ上でe々の信号としてQう ことができるか？  またその周波数以上で吮净したとき の吮镜悚颔哎楗栅恕瘠鞘兢弧1.00下恧危菠膜尾àADQするためには何Hz以上の周波数で吮净すればコ ンピュ`タ上でe々の信号としてQうことができるか？  またその周波数で 本化したときの吮镜悚颔哎楗栅恕瘠鞘兢弧?   ２つの波は sin(2*π*t),  sin(2*π*7*t+pi) よりナイキスト吮净周波数 は14Hz。よって14Hz以上で吮净すればコンピュ`タ上でe々の信号と してQえる。例えば16Hzで吮净すると1.00ヒント：２つの波はsin(2*π*t):?      1Hzの正弦波sin(2*π*7*t+π)?      7Hzの正弦波ナイキスト吮净周波数は？0.00-1.000.00                             0.50                             1.000.00-1.000.00                                              0.50                                              1.00量子化`差量子化`差とは?   量子化するHの真との差?   量子化ビット数が大きいと量 子化`差は小さくなるが、 デ`タ量は大きくなる。8段Aに量子化した龊险穹                              量子化`差rg BAした赤い上の振幅（青い点） を８段Aにした（v色の点）の中で近 いほうのを\丸のrgにおけると するアナログ演n}(4/4)下恧尾à摔いて吮净周波数８Hz、量子化ビット 数3bitsでADQしたときの量子化`差の平均を 算出せよ。1.00?   音のレコ`ディングでは量子 化ビット数のx定が最も困y? 理由は入力される音の大きさ が予めわからないため。?      gH、音SCDは16bitsで量子化されている が、マスタ`レコ`ディングのHにはもっと 大きな量子化ビット数（最近では24bits）を 割り当てている。q1/2q量子化`差デジタルrgヒント：?   sin(2*π*t)?   8Hzで吮净するとtは??   3bitsで量子化すると分解能は？?   sin(π/4) P 0.707?   `差は~でu0.00-1.000.00                                                      0.50                                                      1.00演n}(4/4) 解答例下恧尾à摔いて吮净周波数８Hz、量子化ビット数3bitsでADQしたときの 量子化`差の平均を算出せよ。ポイント： rgS方向：8Hzでの吮净なので1秒gを1/8g隔で等分| 量子化  －  真 |1: | 0.143 - 0.0 |      = 0.1432: | 0.714 - 0.707 |  = 0.0073: | 1.0 - 1.0| = 0.0振幅S方向：                            ３7/7=1.0   1.005/7=0.7143/7=0.4293bitsの量子化なので全振幅を2 = 8（７等分）で表F4: | 0.714 - 0.707 |  = 0.0075: | 0.143 - 0.0 |      = 0.1436: | -0.714 - (-0.707) | = 0.0077: | -1.0 - (-1.0)| = 0.08: | -0.714 - (-0.707) | = 0.0079: | 0.143 - 0.0 |  = 0.1431/7=0.1430.00-1/7=-0.143-3/7=-0.429-5/7=-0.714-7/7=-1.0 -1.000.00                                                0.50                                                1.00量子化`差の合  ：  ０．４５7平均：  P0.05a足： 通常8Hzで吮净すると吮镜悚希傅悚扦 が、まだ周期v数としてQう概念を教えて いないので、Fr点では９点分の`差の合 の平均を算してください。ただし信号 が周期v数であると理解している学生は、 最後の９点目を含めなくても}ないです。4デジタル信号I理第３回vxY料（x散rg信号  －rgI域表F－）立命^大学 情罄砉ぱР  メディア情笱Э 李  亮２０１６．９．２２今回のvx内容【土】ＡＤQ?   アナログ信号からデジタル信号にQ?   吮净と量子化について?   波についてx散rg信号?   rgI域信号と周波数I域信号【土】ＡＤQ（アナログからデジタルへのQ）                                              【a足】波について石をポチャ!!アナログ信号この部分を 大する。1,  3,  6,  9,  10,  8, …デジタル コンピュ`タ波とは?     「振印工工毪猡韦あって、それが周 欷恕护铯盲皮妞」F象? 例：池に石を投げると、石が落ちたと ころでは、水面の高さが上下に震 し、その位置を中心にして波がを 描いて四方へ贿_? デジタル信号I理では、波（アナログ 信号）をデジタル信号としてQいI理上下の振护铯盲皮妞リ`ン、リ`ンrg（秒）(a)   アナログ信号（rgもRもBA量）吮净                                                         量子化（秒）吮净g隔(b) 吮净後の信号(C) 量子化後の信号（秒）?     音も「波」（光や地震、磁波も「波」）? たとえばバイオリンの龊稀バイオリ ンの弦の「振印工摔瑜辍この振婴 弦に接している空荬畏肿婴颉刚印 させ、空葜肖颉护铯盲皮妞」。そし て、この空荩à畏肿樱─握婴耳まかな！？（rgはx散量、振幅はBA量）（rgも振幅もx散量）で护铯辍⒐哪い蛘婴丹护毪长趣恰 我々は「音」として知1.00【a足】波の表F方法?  周波数? 周波数とは，1秒gにRり返される波の数のことで，ヘルツ(Hz)と いうg位で表Fする。gにいえば振婴嗡伽怠＠えば，空荬握 邮を指す龊悉希耳でこえる音の高さとして使用1.001.00【土】  前回演n}(1/4)3Hzの波を吮净周波数8Hzでx散rg信号にQすると？1.00sin(2*π*t)                   sin(2*π*3*t+π)0.000.000.000.00sin(2*π*3*t+π)-1.000.00                                              0.50                                             1.00-1.000.00                                               0.50                                               1.00-1.00-1.000.00                                                0.50                                                1.00   0.00                                                 0.50                                                 1.00吮净：あるrgg隔で信号を取り出すこと1Hzの波（１秒gに波が１回Rり返すから）3Hzの波（１秒gに波が３回Rり返すから）8Hzで吮净する  ＝  １秒gに８回信号を取り出す1【土】  前回演n}（2/4）3Hzの信号を8Hzで吮净したx散rg信号を2bitsで量子量子化`差量子化`差とは8段Aに量子化した龊险穹                              量子化`差rg1.000.00化してデジタル信号にQ1.000.00?   量子化するHの真との差?   量子化ビット数が大きいと量 子化`差は小さくなるが、 デ`タ量は大きくなる。BAした赤い上の振幅（青い点） を８段Aにした（v色の点）の中で近 いほうのを\丸のrgにおけると するアナログ-1.000.00                                           0.50                                           1.00-1.000.00                                           0.50                                           1.00?   音のレコ`ディングでは量子 化ビット数のx定が最も困y    q? 理由は入力される音の大きさ が予めわからないため。デジタル量子化：あるg隔で振幅をデジタル量（x散量）にQすること2bitsで量子化する  ＝  振幅を2  (=4)でx散量にQする。＝  全振幅を３等分することに等しい。 量子化するときは、真からもっとも近い量子化点で量子化する。?      gH、音SCDは16bitsで量子化されている が、マスタ`レコ`ディングのHにはもっと 大きな量子化ビット数（最近では24bits）を 割り当てている。1/2qrg量子化`差前回演n}(4/4)下恧尾à摔いて吮净周波数８Hz、量子化ビット 数3bitsでADQしたときの量子化`差の平均を前回演n}(4/4) 解答例下恧尾à摔いて吮净周波数8Hz、量子化ビット数3bitsでADQしたときの 量子化`差の平均を算出せよ。| 量子化  －  真 |算出せよ。1.00ポイント：rgS方向：8Hzでの吮净なので1秒gを1/8g隔で等分1: | 0.143 - 0.0 |      = 0.1432: | 0.714 - 0.707 |  = 0.0073: | 1.0 - 1.0| = 0.0振幅S方向：                            ３ヒント：?   sin(2*π*t)?   8Hzで吮净するとtは??   3bitsで量子化すると分解能は？?   sin(π/4) P 0.707?   `差は~でu0.00-1.000.00                                                      0.50                                                      1.007/7=1.0   1.005/7=0.7143/7=0.4291/7=0.1430.00-1/7=-0.143-3/7=-0.429-5/7=-0.714-7/7=-1.0 -1.003bitsの量子化なので全振幅を2 = 8（７等分）で表F4: | 0.714 - 0.707 |  = 0.0075: | 0.143 - 0.0 |      = 0.1436: | -0.714 - (-0.707) | = 0.0077: | -1.0 - (-1.0)| = 0.08: | -0.714 - (-0.707) | = 0.0079: | 0.143 - 0.0 |  = 0.143量子化`差の合  ：  0.457平均：  P0.05a足： 通常8Hzで吮净すると吮镜悚希傅悚扦 が、まだ周期v数としてQう概念を教えて いないので、Fr点では９点分の`差の合 の平均を算してください。ただし信号 が周期v数であると理解している学生は、0.00                                                0.50                                                1.00最後の９点目を含めなくても}ないです。演n}(1/5)3Hzの波を吮净周波数4Hz、量子化2bitsで デジタル信号にQせよ。演n}(1/5) 解答例3Hzの波を吮净周波数4Hz、量子化2bitsで デジタル信号にQせよ。ヒント：?     まず4Hzで吮净?     その後2bitsで量子化?     デジタル信号は数字列?     よって答えは…1.000.00ヒント：?     まず4Hzで吮净?     その後2bitsで量子化?     デジタル信号は数字列? サンプル１  1/3=0.33? サンプル２  3/3=1.00? サンプル３  1/3=0.33? サンプル４  -3/3=-1.00? サンプル５   1/3=0.331.000.00-1.000.00                                                 0.50                                                 1.00-1.000.00                                                 0.50                                                 1.00? 答え：  0.33(-0.33), 1.00, 0.33(-0.33), -1.00, 0.33(-0.33)2演n}(2/5)吮净にvする}? オ`ディオ周波数（可周波数）は20Hz～20,000Hz である。このオ`ディオ信号をデジタル信号I理する 龊稀その吮净（サンプリング）周波数はいくらがm 当か？?   ＣＤ (Compact Disk) では、サンプリング周波数を44100Hzとしている。エイリアシングなく吮净（サンプリング）するためには、ＡＤQ前のアナログ信号に おいて、周波数成分をどのように制限しておく必要があるか。ヒント（エイリアシング）： 信号の持つ最高周波数の２倍以上で吮净しないと波の折り返しが生じ、品|が劣化する。演n}(2/5) 解答例１吮净にvする}?   オ`ディオ周波数（可周波数）は20Hz～20,000Hzで ある。このオ`ディオ信号をディジタル信号I理する 合、その吮净（サンプリング）周波数はいくらがm当 か？? 最高周波数の２倍以上で吮净すれば信号が劣化 することはない。? よって、20,000 * 2 =   40,000Hz以上ヒント（エイリアシング）： 信号の持つ最高周波数の２倍以上で吮净しないと波の折り返しが生じ、品|が劣化する。演n}(2/5) 解答例２吮净にvする}?   ＣＤ (Compact Disk) では、サンプリング周波数を44100Hzとしている。エイリアシングなく吮净（サンプリング）するためには、ＡＤQ前のアナログ信号におい て、周波数成分をどのように制限しておく必要があるか。? サンプリング周波数が44,100Hzということは、品|が 保障できるのは22,050Hzまで。? よって、最初に周波数成分を22,050Hｚ以下にしてお かないとエイリアシングが生じ、信号が劣化する。x散rg信号についてrgI域表F?   デジタル信号I理の基本はx散rg信号?   デジタル信号? x散rg信号の大きさを数（量子化）で表Fしているだけ? これからは   「デジタル信号」＝「x散rg信号」としてd?   どうやってx散rg信号を得るのか？? サンプラ`のON/OFFを周期Ｔで行うことにより、信号をx散化アナログ信号化                    サンプラ`                     パルス列信号サンプラ`がONのときのみを持つx散rg信号 サンプラ`が短いrgだけONにするときx散rg信号 －デルタv数１－g位面eパルス信号                   デルタv数（（g位）インパルスv数）1?x散rg信号 －デルタv数２－デルタv数（インパルスv数）の表?   r刻０にパルスがあるデルタv数：?   r刻τにパルスがあるデルタv数：パルス：? ?   0  ?2         2t                                  0                 tデルタv数（インパルスv数）： 幅０、振幅１の信号。面eは１。Z源は}拍。通常パルスという と１回の波をさす。? (t) ? 0(t ? 0)r刻t以外の振幅は０g位面eパルス（信号）：                                  ?幅ε、高さ1/εの信号。面eは１                       ?? (t)dt ? 1-∞～∞までe分すると１（＝全体の面eが１）??3x散rg信号 －rgI域表F１－サンプラ`v数の表?   サンプラ`がONになるときは、s(t ) ? ? ? ? (t ? 1) ? ? (t ) ? ? (t ?1) ? ? (t ? 2) ? ??x散rg信号 －rgI域表F２－x散rg信号の表?      x散rg信号?      アナログ信号?      サンプラ`?      サンプリング周期    Ｔ?      サンプル数             nデルタv数? ?? (t ? nT )n ???このサンプラ`のタイミン グに振幅を考]すれば、 x散rg信号になる?x* (t ) ? x(t)s(t)?? x(t) ?? (t ? nT )n ????? ? x(t )? (t ? nT )n????アナログ信号とサンプラ`のr刻tにおける欷彼 サンプラ`をx散表するとx散空gではtはTg隔でしかを持たないので  x(t)は x(nT)表Fすることができ、最K的には各r刻におけるアナ ログ信号とサンプラ`の欷彼悚魏嫌で信号を表せる? ? x(nT )? (t ? nT )  gHに信号はマイナスr刻でをもたないので、合n???する欷nが０から∞となる。x散rg信号 －rgI域表F３－演n}(3/5)アナログ信号次のような信号x(t )をx散信号化して得られる x* (t ) の式を示せ。t                                                                                              ?e??tx(t) ? ?(t ? 0)??サンプラ`v数? 0  (t ? 0) ?tx散rg信号tヒント： vxY料をよく_Jしてください。演n}(3/5) 解答例次のような信号 x(t ) をx散信号化して得られる x* (t )の式を示せ。x散rg信号 －周波数I域表F１－rgSの信号をx散化できれば、当然周 波数S上の表もx散化可能vxY料より、?e??tx(t ) ? ?? 0(t ? 0)??(t ? 0)  ??  rgS上  rgｔの表?  周波数S上   }素数での表? なぜなら周波数は振幅と位相を持っているから?x* (t ) ? ? x(nT )? (t ? nT )n ? ???x散表したアナログ信号とサンプラ`の欷彼??  x散rg信号の周波数I域表Fに入る前に }素数の土? ? x(nT )? (t ? nT ) ? ? e??nT ? (t ? nT )n ?0n ?0信号は正ののみ              を代入すると4【土】}素数}素数とは?     ２つのg数  a と  b  および虚数g位  j を用いてa + jb と表Fする数?   a をg部、  b を虚部と呼ぶ演n}(4/5)}素ベクトルにおいて振幅＝３、位相＝π/４のと き、g部aと虚部bのはいくつになるか？虚S                                                   振幅：a2 ? b2ヒント 振幅：虚Sa2 ? b2}素ベクトルba位相： arctan( b )agS位相： arctan( b )agSa演n}(4/5) 解答例}素ベクトルにおいて振幅＝３、位相＝π/４のと き、g部aと虚部bのはいくつになるか？虚Sヒント振幅：  sqrt(a2  + b2) ＝ ３ 位相：  arctan(b/a) = π/4b【土】回ベクトル虚S}素数表F 角周波数 ? (? 2?f ) 位相 ?振幅 aベクトルＡ振幅＊回角A ? a ? e j?  ? a(cos? ? j sin? )e j?t  ? ceojs? ??t c?osj ?sin??jtsin?オイラ`の公式sin(π/4) = 1/√2 cos(π/4) = 1/√2a = 3 * cos(π/4)b = 3 * sin(π/4)３π/4gSagS回ベクトルv(?t) ? a ? e j (?t ?? )  ? a ? e j? ? e j?t? A ? e j?tベクトルＡ＊回角a = 3 /√2,  b = 3 /√2演n}(5/5)}素ベクトルＡにおいて振幅a＝３、位相θ＝ π/４の}素ベクトルをπ/12だけ回させる と、g部と虚部のはいくつになるか？演n}(5/5) 解答例}素ベクトルＡにおいて振幅a＝３、位相θ＝π/４の}素ベクトルをπ/12だけ回させると、g部と虚部のはいくつになるか？ヒント： 回ベクトルv(?t) ? a ? e j (?t ?? )  ? a ? e j? ? e j?t? A? e j?tヒント： 回ベクトルv(?t) ? a ? e j (?t ?? )  ? a ? e j? ? e j?t? A? e j?tg部 = 3 * cos(π/4 +π/12)虚部 = 3 * sin(π/4 + π/12)g部 = 3/2,   虚部 =3√3/25デジタル信号I理第４回vxY料（x散rg信号  -周波数I域表F-）立命^大学 情罄砉ぱР  メディア情笱Э 李  亮２０１６．９．２３今回のvx内容【土】前回vxの土?   rgI域信号はどうやって表すのか？?   }素数とはどういうものか？x散rg信号?   周波数I域信号?   フ`リエ数展_?   スペクトル表など【土】x散rg信号についてrgI域表F?   デジタル信号I理の基本はx散rg信号?   デジタル信号? x散rg信号の大きさを数（量子化）で表Fしているだけ? 教科では、２章以後は  「デジタル信号」＝「x散rg信号」と してd?   どうやってx散rg信号を得るのか？? サンプラ`のON/OFFを周期Ｔで行うことにより、信号をx散化【土】x散rg信号 －rgI域表F－アナログ信号tサンプラ`v数tx散rg信号アナログ信号化                    サンプラ`                     パルス列信号サンプラ`がONのときのみを持つx散rg信号サンプラ`が短いrgだけ                                                                                                                                                                    tONにするとき【土】x散rg信号 －周波数I域表F１－rgSの信号をx散化できれば、当然周 波数S上の表もx散化可能?  rgS上  rgｔの表?  周波数S上   }素数での表【土】}素数}素数とは?     ２つのg数  a と  b  および虚数g位  j を用いてa + jb と表Fする数?   a をg部、  b を虚部と呼ぶ虚S? なぜなら周波数は振幅と位相を持っているから振幅：a2 ? b2b?  x散rg信号の周波数I域表Fに入る前に }素数の土}素ベクトルb位相： arctan(  )agSa1【土】回ベクトル虚S}素数表F 角周波数 ? (? 2?f ) 位相 ?振幅 aベクトルＡ振幅＊回角A ? a ? e j?  ? a(cos? ? j sin? )e j?t  ? ceojs? ??t c?osj ?sin??jtsin?オイラ`の公式gS回ベクトルv(?t) ? a ? e j (?t ?? )  ? a ? e j? ? e j?t? A ? e j?tベクトルＡ＊回角周波数I域表F信号をどうやって周波数で表Fするのか？?   「rgI域の信号を周波数I域に射影（Q）」?   どうやってQするのか？? 一般的には、回ベクトルを用いてrgI域の信号から周波数I域の 信号へQ?    周波数とは，1秒gにRり返される波の数のこと? rgI域の信号にして、どんな波が１秒gに何回Rり返しているのか を解析することで、周波数I域にQできる例：  周波数表F?     身近なものとしては、? ラジカセなどのイコライザ（音のa正I理）などは周波数表F?    音を周波数で表Fしている  （だから低音の{などができる）? ラジオやテレビの波も周波数表F?    波を周波数で表Fしている。  （だから}数の番Mを受信できる）身近な射影（Q）の例コンビニエンスストアの１日の客数周波数I域への道フ`リエ数とは250200rg 15010050?  フランスの数学者  フ`リエが考案?  「任意の周期v数は三角v数の和として表せる」?  「任意の周期v数」060 01     2     3     4     5     6     7     8     9    10   1 1    12    13    1 4   15rgI域の信号 から年hI域の 信号にQ? ある１周期分の波形が同じ波形でRり返しk生する v数のこと。50 040 030 020 010 0010才台            20才台            30 才台            40才台            50才台rgI域?周波数I域 も同じ考え方（同じものに する方が`うだけ）フ`リエ数展_（１）フ`リエ数展_（２）：  周期 Ｔ秒でRり返される信号フ`リエ数の考え方：信号 x(t)はＴ秒で１周期、すなわち周波数1/T(Hz)の成分と、その整数倍 の周波数成分（2/T,  3/T, 4/T, …(Hz)）のo限和として表Fm=1のとき?     基本波成分m>1のとき?     高{波成分直流成分フ`リエS数ポイント： どんな波もcosとsinで表せる ということは、すべてのcosと sinの波を足し合わせれば元 の信号になる。2フ`リエ数展_（３）フ`リエS数の算出フ`リエ数展_のポイント フ`リエS数信号の直流成分の振幅フ`リエS数各周波数 m/T(Hz)のcos成分、sin成分の振幅周波数I域に射影完了演n}（1/4）演n}（1/4） 解答例周期信号x(t)が下のように分解できるとき、x(t)のフ` リエ数展_はどのように表Fできるか？周期信号x(t)が下のように分解 できるとき、x(t)のフ`リエ数展_は どのように表Fできるか？ヒント： フ`リエ数展_（１）のY料を参考に、 を代入すればよいヒント： フ`リエ数展_（１）の Y料を参考に、を代入 すればよいAns.x(t) = 3 + 2cos2πt + 1.5cos4πt + 2cos6πt + 1cos8πt +…+ 4sin2πt + 3sin4πt + 5sin6πt + 2sin8πt  +…【g演】フ`リエ数展_1m=0まで(赤)、m=1(青)10                                                                                                                                               0-1-0.5      -0.4      -0.3      -0.2      -0.1        0        0.1       0.2       0.3       0.4       0.5-1-0.5      -0.4      -0.3      -0.2      -0.1       0        0.1       0.2       0.3       0.4       0.53m=1まで(赤)、m=2(青)1m=2まで(赤)、m=3(青)10                                                                                                                                              0-1-0.5      -0.4      -0.3      -0.2      -0.1       0        0.1       0.2       0.3       0.4       0.5-1-0.5      -0.4      -0.3      -0.2      -0.1       0        0.1       0.2       0.3       0.4       0.5m=3まで(赤)、m=4(青)1m=10まで(赤)、m=11(青)10                                                                                                                                              0-1-0.5      -0.4      -0.3      -0.2      -0.1       0        0.1       0.2       0.3       0.4       0.5-1-0.5      -0.4      -0.3      -0.2      -0.1       0        0.1       0.2       0.3       0.4       0.5m=100まで(赤)、m=101(青)1フ`リエ次数mについて0-1-0.5      -0.4      -0.3      -0.2      -0.1       0        0.1       0.2       0.3       0.4       0.5?   m のが小さいと低い周波数、m のが大きくなると 高い周波数を示す。（g演どおり）?   rgI域の信号から周波数I域の信号にQする 龊悉悉长mとTのvSが非常に重要4演n} (2/4)下のフ`リエ数展_においてmのを０から２０まで 出力した龊稀⒑Hz～何Hzの信号を何Hzおきに表Fで きるか？                                           ヒント：周波数はm/Tで表F演n} (2/4)  解答例下のフ`リエ数展_においてmのを０から２０まで出力した龊稀⒑Hz～何Hzの信号を何Hzおきに表Fできるか？ヒント： 周波数はm/Tで表FAns.スペクトル（振幅、パワ`、位相）スペクトル?     rgS信号(rgI域）を周波数S（周波数I域）で表Fしたもの。 音信号 ではrgSの信号を「波形」と呼ぶのにし周波数Sの信号を「スペクトル」と 呼ぶ。スペクトル表（振幅、パワ`、位相）フ`リエS数b振幅スペクトル?     スペクトルの振幅を示す。音信号では象周波数の大きさを示す。パワ`スペクトル?     スペクトルのエネルギ`を示す。音信号では象周波数のエネルギ`（パ ワ`：  振幅の２\）を示す。位相スペクトル?     スペクトルのM度を示す。基市藕扭して象周波数がずれているとき、位 相スペクトルが「Wれている」とか「Mんでいる」と表Fする。のS sin成分m/T(Hz)の スペクトルフ`リエS数aのS cos成分m/T(Hz)の振幅スペクトル：m/T(Hz)のパワ`スペクトル：m/T(Hz)の位相スペクトル：振幅＊回角演n}（3/4）下のようなフ`リエS数が得られたとき、各周波数にお ける振幅スペクトルとパワ`スペクトルを求めよ。（ここでは1Hz～4Hzまでの信号とする。周期Ｔ＝１秒とする。）ヒント：スペクトル表を参考に。演n}（3/4）  解答例下のようなフ`リエS数が得られたとき、各周波数における振幅スペクト ルとパワ`スペクトルを求めよ。（ここでは1Hz～4Hzまでの信号とする。周 期Ｔ＝１秒とする。）ヒント：スペクトル表を参考に。振幅スペクトルパワ`スペクトルAns.振幅スペクトル|X1 | = sqrt( pow(2) + pow(4) ) =     20|X2 | = sqrt( pow(1.5) + pow(3) ) =    11.25|X3 | = sqrt( pow(2) + pow(5) ) =       29|X4 | = sqrt( pow(1) + pow(2) ) =       5パワ`スペクトル|X1| = pow(2) + pow(4)  = 20|X |2 = pow(1.5) + pow(3)  = 11.252|X3| = pow(2) + pow(5)  = 29|X4| = pow(1) + pow(2)  = 55}素フ`リエ数展_フ`リエ数展_を}素数を使って表すと、フ`リエ数展_のまとめすべての波はcosとsinで表F可能?   フ`リエ数展_によりrgI域の信号を周波数I域 の信号へ射影可能?   cos とsin成分は各周波数(何Hzか？)を示し、フ`リエ S数は各周波数スペクトル（振幅や位相など）を示す}素フ`リエS数からスペクトルを求めるためには、高{波成分を考]すればするほど、高精度に周 波数I域へ射影可能?   忠gに射影可能?   次数（m）が小さいと正_に射影できない。しかしながら 大j把な射影はできる。（g演を参考に）}素スペクトルの肀碛例                     演n}（4/4）rgI域の信号  x(t)が下のように表せるとき、 振幅スペクトル、パワ`スペクトル、位相スペクト ルを硎兢护琛￥郡坤分芷冢裕0.1秒（100ms）と する。大ヒント：  スペクトルは下のように表せる演n}（4/4） 解答例（１）演n}（4/4） 解答例２rgI域の信号 x(t)が下のように表せるとき、振幅スペクトル、パワ`ス ペクトル、位相スペクトルを硎兢护琛４螗谣螗龋  スペクトルは下のように表せるm/T(Hz)の振幅スペクトル：m/T(Hz)のパワ`スペクトル：m/T(Hz)の位相スペクトル：6演n}（4/4） 解答例３                        演n}（4/4） 解答例４フ`リエ数展_の意xUrsus Wehrli: The Art of Clean Upフ`リエ数展_の意xUrsus Wehrli: The Art of Clean Upフ`リエ数展_の意xフ`リエ数展_の意xFourier, 1764-1830Ursus Wehrli: The Art of Clean Up7フ`リエ数展_の意xLeonhard Euler, 1707～1783Ursus Wehrli: The Art of Clean Upフ`リエ数「任意の周期v数は三角v数の和として表せる」8デジタル信号I理第５回vxY料 （周波数解析）立命^大学 情罄砉ぱР  メディア情笱Э 李  亮２０１６．９．２３今回のvx内容【土】前回vxの土?   周波数I域信号について?   フ`リエ数展_?   スペクトル表など周波数解析（スペクトル解析）?   スペクトルの特?   x散フ`リエQ【土】周波数I域表F信号をどうやって周波数で表Fするのか？?   「rgI域の信号を周波数I域に射影（Q）」?   どうやってQするのか？? 一般的には、回ベクトルを用いてrgI域の信号から周波数I域の 信号へQ?    周波数とは，1秒gにRり返される波の数のこと? rgI域の信号にして、どんな波が１秒gに何回Rり返しているのか を解析することで、周波数I域にQできる例：  周波数表F?     身近なものとしては、? ラジカセなどのイコライザ（音のa正I理）などは周波数表F?    音を周波数で表Fしている  （だから低音の{などができる）? ラジオやテレビの波も周波数表F?    波を周波数で表Fしている。   （だから}数の番Mを受信できる）【土】周波数I域への道フ`リエ数とは?  フランスの数学者  フ`リエが考案?  「任意の周期v数は三角v数の和として表せる」?  「任意の周期v数」? ある１周期分の波形が同じ波形でRり返しk生するv 数のこと。【土】フ`リエ数展_【土】スペクトル（振幅、パワ`、位相）スペクトル?     rgS信号(rgI域）を周波数S（周波数I域）で表Fしたもの。 音信号 ではrgSの信号を「波形」と呼ぶのにし周波数Sの信号を「スペクトル」と 呼ぶ。フ`リエ数展_のポイント フ`リエS数信号の直流成分の振幅フ`リエS数各周波数 m/T(Hz)のcos成分、sin成分の振幅周波数I域に射影完了振幅スペクトル?     スペクトルの振幅を示す。音信号では象周波数の大きさを示す。パワ`スペクトル?     スペクトルのエネルギ`を示す。音信号では象周波数のエネルギ`（パ ワ`：  振幅の２\）を示す。位相スペクトル?     スペクトルのM度を示す。基市藕扭して象周波数がずれているとき、位 相スペクトルが「Wれている」とか「Mんでいる」と表Fする。1【土】 スペクトル表（振幅、パワ`、位相）フ`リエS数b【土】 フ`リエ数展_のまとめすべての波はcosとsinで表F可能?  フ`リエ数展_によりrgI域の信号を周のS sin成分m/T(Hz)の スペクトルフ`リエS数aのS cos成分m/T(Hz)の振幅スペクトル：m/T(Hz)のパワ`スペクトル：m/T(Hz)の位相スペクトル：波数I域の信号へ射影可能?  cos とsin成分は各周波数(何Hzか？)を示し、 フ`リエS数は各周波数スペクトル（振幅や位 相など）を示す振幅＊回角スペクトルの特眨ǎ保┲芷谛?     x散rg信号のスペクトルは周期性を持つ?     例えば、吮净周波数(fs)が16kHzの信号のスペクトルは、基本 スペクトル(0Hz-16kHz)に基づく周期を持つ? 振幅スペクトル、パワ`スペクトル、位相スペクトルとも周期性を持つ基本スペクトルスペクトルの特眨ǎ玻称性?     x散rg信号のスペクトルは称性を持つ?     例えば、吮净周波数fsが16kHzである信号のスペクトルは、8kHz(fs/2)を境に称となる。? 振幅スペクトル、パワ`スペクトル、は8kHz(fs/2)を中心に折り返し? 位相スペクトルは8kHz  (fs/2)を中心に折り返し、正を反した称性 を持つ0Hz                    16kHz                    32kHz周波数0Hz8kHz16kHz周波数演n}（1/4）例のように、もとの信号のスペクトル(a)が吮净周波数(fs)の1/2以下で あれば、周期性と称性はスペクトル(b)のように表せる。では、もとの信 号のスペクトルが(c)のように吮净周波数(fs)の1/2以上だとすると周 期性と称性を考]したスペクトルはどのように表せるか? (b)を参考に 硎兢护琛(a)                                                (b)演n}（1/4）  解答例例のように、もとの信号のスペクトル(a)が吮净周波数(fs)の1/2以下で あれば、周期性と称性はスペクトル(b)のように表せる。では、もとの信 号のスペクトルが(c)のように吮净周波数(fs)の1/2以上だとすると周 期性と称性を考]したスペクトルはどのように表せるか? (b)を参考に 硎兢护琛！(c)0       fs/20     fs/2-fs-fs/20       fs/2      fs      3fs/2    2fs？   ヒント：エイリアシングを 周波数S上で考えれば。。。0     fs/2○-fs-fs/20       fs/2       fs      3fs/2     2fs2【土】 吮净定理（シャノンの吮净定理）吮净周波数をQめる１つの目安 アナログ信号の持つ最高の周波数が    Hzであるとき吮净周波数    は    の２倍以上にO定1.000.00エイリアシングの例1.00sin(2*π*t)0.001Hzの正弦波sin(2*π*3*t+π)3Hzの正弦波-1.00-1.000.00                                                0.50                                                1.00   0.00                                                 0.50                                                 1.001: ナイキスト吮净周波数?   例：  信号の最高周波数が200Hzの龊稀吮净は400Hz以上の周波数でADQ?  もしナイキスト吮净周波数以下で吮净するとエイリアシング（波の重なりもしくは波の折り返しという意味）がk生２つの信号を吮净周波数４Hz(吮净g隔0.25秒）で吮净すると２つの信号は重なってえる。デジタル信号ではこの２つの信号は同じと判断?  高い周波数は低い周波数にえる?  必ずナイキスト吮净周波数以上で吮净この龊悉坤6Hz以上で吮净する必要あり-10                                        0.5                                        1スペクトルの特眨ǎ常━攻讠トル上でのエイリアシング?   アナログ信号の最大周波数(fh)と吮净周波数fsのvS○            最大周波数(fh)  ＜  吮净周波数(fs) / 2エイリアシング策エイリアシングを回避するために、?   必ずアナログ信号からデジタル信号にQするときは、を守する。?   予め吮净周波数fsがQまっている龊悉稀? アナログ信号にしてフィルタI理（後半のvxでh明予定）０                   fs/2                  fs3fs/22fsを行い、アナログ信号の最大周波数fhが吮净周波数の1/2以下になるように不要な周波数を除去する。× 折り返しがk生最大周波数(fh)  ＞  吮净周波数(fs) / 2? これにより、エイリアシングは回避可能? 一般的な音Sのレコ`ディングでは、音SCDの吮净周波 数fsが44100HzとQまっているので、レコ`ディングした音 信号にしてフィルタI理を行い、最大周波数fhが22050Hz 以下になるように不要な周波数を除去して音SCDをu作して いる。０            fs/2fs            3fs/22fs演n}(2/4)Ａ君は音SＣＤ（吮净周波数44100Hz）をu作しようとして います。しかしながら、エイリアシング}を考]せずに（フィルタI理なしに）レコ`ディングを行ったため、音信号（アナログ信号）の最大周波数が25000Hzになってしまいま した。?     このまま音信号（アナログ信号）を44100Hzで吮净して、音SＣ Ｄとして再生するとどうなるか？? 音信号（アナログ信号）を44100Hzで吮净した後に、フィルタI 理により、22050Hz以上の信号を除去して、音SＣＤを再生するとど うなるか？?     音信号（アナログ信号）にして22050Hz以上の信号を除去する フィルタI理を行った後に、44100Hzで吮净して音SＣＤを再生す るとどうなるか？ヒント：エイリアシングはどのr点で k生するかよく考えてください。演n}(2/4) 解答例１?  このまま音信号（アナログ信号）を44100Hzで 本化すると、? エイリアシングがk生するため高域信号がひず む。特に19,100Hz以上でエイリアシングの影を 受ける。? ∮虮Ｕ希吮净周波数の1/2）は44,100Hz/2 = 22,050Hzよって ( ∮虮Ｕ现懿ㄊ  C 折り返し周波数 ) が歪の影を受けない信号の上限とな る。よって  22,050Hz C (25,000Hz C22,050Hz) = 19,100Hzとなる。3演n}(2/4) 解答例２?  音信号（アナログ信号）を44100Hzで吮净した 後に、フィルタI理により、22050Hz以上の信号を除 去すると、? さきほどと同じく、19,100Hz以上の∮颏钎ēぅ辚 シングの影を受ける。吮净した後に22050Hz 以上の信号を除去しても何も浃铯椁胜ぁ? なぜなら吮净した段Aでアナログ信号rに 存在した22,050Hz以上の信号は、折り返して22050Hz以下の信号に混在しているから。演n}(2/4) 解答例３?  音信号（アナログ信号）にして22050Hz以上の 信号を除去するフィルタI理を行った後に、44100Hzで吮净すると? サンプリング定理を氦郡工韦恰⒁糍|はアナログ 信号rと同程度を保障可能。ただし、22050Hz以 上の信号は除去されていることに注意。（しかし、 歪はk生しない。）x散フ`リエQとはDiscrete Fourier Transform (DFT)フ`リエ数展_に基づく周波数解析法?   フ`リエ数展_：  （BA信号を⒍ǎ? すべての周期v数はsinとcosで表F可能x散フ`リエQx散信号と回子の内eの和で スペクトル解析可能g部                                虚部?   x散フ`リエQ：  （x散信号を⒍ǎ? 基本スペクトル（0Hz～fs）の解析x散信号と回子の内eの和で スペクトル解析可能スペクトル              x散フ`リエQの式からも スペクトルは必ず}素I域でないと 表Fできないことがわかる。g部x散フ`リエ逆Qx散フ`リエQ：?   x散信号からスペクトルへQx散フ`リエQにおけるスペクトル表x散フ`リエQx散信号と回子の内eの和で スペクトル解析可能x散フ`リエ逆Q?   スペクトルからx散信号へQ基本的には1/Nする以外は算手は同じ。また教科によっては x散フ`リエQで1/Nする龊悉猡るが、その龊悉夏Qで1/Nは行わない振幅スペクトル パワ`スペクトルg部                                虚部 位相スペクトル4x散フ`リエQの性|（１）周期信号を⒍à筏Q?     x散フ`リエQは有限L の信号をQ?     切り出した信号がRり返して いる（周期信号である）と 定してスペクトルにQ?     よって非周期信号にして x散フ`リエQを行う 合には注意が必要。（gH の信号とはなったスペクト ルになる可能性あり）x散フ`リエQの性|（２）x散フ`リエQのスペクトルは?   周期性?   称性 を持つ。（vxY料でh明したとおり。）0Hz8kHz16kHz演n}(3/4)周期性x散rg信号       の１周期 (N=4) が下 の式で表せるとき、周波数解析をx散フ`リエQ を用いて行え1演n}(3/4) 大ヒント}素数虚Sj?? 1x(nT ) ? ?? 1(n ? 0,1)(n ? 2,3)0    1    2    3-1                                                -1gS1           exp( 0 ) = 1ヒント：  x散フ`リエQの式に上を代入して 算するだけ（答えは}素数になることに注意！）exp(-j π/2) = -j exp(-j π) = -1exp(-j 3π/2) = j-j演n}(3/4) 解答例(1)X(0) =    x(0) exp(-j 2π0 0/4) + x(1) exp(-j 2π1 0/4)+ x(2) exp(-j 2π2 0/4) + x(3) exp(-j 2π3 0/4)=    (-1) exp(0) + (-1)exp(0) + 1 exp(0) + 1 exp(0)=    (-1) ? 1 + (-1) ? 1 + 1 ? 1 + 1 ? 1=    (-1) + (-1) + 1 + 1=    0 + j0以下同じようにX(1), X(2), X(3) を算すればよい。演n}(3/4) 解答例(2)X(1) =    x(0) exp(-j 2π0 1/4) + x(1) exp(-j 2π1 1/4)+ x(2) exp(-j 2π2 1/4) + x(3) exp(-j 2π3 1/4)=    (-1) exp(0) + (-1)exp(-j  π/2)+ 1 exp(-j π) + 1 exp(-j 3π/2)=    (-1) ? 1 + (-1) ? (-j) + 1 ? (-1) + 1 ? j=    -2 + j2X(2) =    x(0) exp(-j 2π0 2/4) + x(1) exp(-j 2π1 2/4)+ x(2) exp(-j 2π2 2/4) + x(3) exp(-j 2π3 2/4)=    (-1) exp(0) + (-1)exp(-j  π) + 1 exp(-j 2π) + 1 exp(-j 3π)=    (-1) exp(0) + (-1)exp(-j  π) + 1 exp(0) + 1 exp(-j π)=    (-1) ? 1 + (-1) ? (-1) + 1 ? 1 + 1 ? (-1)=    0 + j05演n}(3/4) 解答例(3)X(3) =    x(0) exp(-j 2π0 3/4) + x(1) exp(-j 2π1 3/4)+ x(2) exp(-j 2π2 3/4) + x(3) exp(-j 2π3 3/4)=    (-1) exp(0) + (-1)exp(-j 3π/2)+ 1 exp(-j 3π) + 1 exp(-j 9π/2)=    (-1) exp(0) + (-1)exp(-j 3π/2)+ 1 exp(-j π) + 1 exp(-j π/2)=    (-1) ? 1 + (-1) ? j + 1 ? (-1) + 1 ? (-j)=    -2 - j2よって、最K的な解答はX(0) =  0 - j0 (gに0でもOK)          X(2) =  0 - j0 (gに0でもOK) X(1) = -2 - j(-2)                           X(3) = -2 - j2演n}(4/4)演n}(3/4)のスペクトル解析Y果を基に、振幅 スペクトル、パワ`スペクトル、位相スペクトルを 示せよ。（横Sは周波数もしくはkのとする。）X(0) = 0 - j0       X(1) = -2 - j(-2) X(2) = 0 - j0       X(3) = -2 - j2ヒント：  x散フ`リエQ式は下のように分解できる。 よって振幅スペクトルは？パワ`スペクトルは？  位相スペクトルは？g部                                虚部演n}(4/4) 解答例(1)振幅スペクトル演n}(4/4) 解答例（２）パワ`スペクトルX(0) = 0 - j08                               8         X(1) = -2 - j(-2) X(2) = 0 - j0X(3) = -2 - j28                               8           X(0) = 0 - j0X(1) = -2 - j(-2)X(2) = 0 - j0X(3) = -2 - j2k0               1              2              3k0               1              2              3k点でx散フ`リエQを行うとk/2を中心にスペクトルの称性がFれる。 振幅スペクトルの龊稀k/2を中心として折り返す形。k点でx散フ`リエQを行うとk/2を中心にスペクトルの称性がFれる。 パワ`スペクトルの龊稀k/2を中心として折り返す形。演n}(4/4) 解答例（3）位相スペクトルtan-1(-2/-2)=tan-1 (1)= π/4X(0) = 0 - j0X(1) = -2 - j(-2) X(2) = 0 - j0X(3) = -2 - j20             1               2             3         ktan-1 (2/-2)=tan-1 (-1)= -π/4位相スペクトルの龊稀k/2を中心に折り返し、正を反した称性を持つ6デジタル信号I理第６回vxY料 （スペクトル`差とv数）立命^大学 情罄砉ぱР  メディア情笱Э 李  亮２０１６．９．２６今回のvx内容【土】前回vxの土?   周波数解析?   スペクトルの特?   x散フ`リエQv数?   v数とは?   なぜv数が必要なのか【土】フ`リエ数展_フ`リエ数展_のポイント フ`リエS数信号の直流成分の振幅フ`リエS数各周波数 m/T(Hz)のcos成分、sin成分の振幅【土】スペクトルの特(1)(2)周期性?     吮净周波数(fs)が16kHzの信号のスペクトルは、基本スペクトル(0Hz-16kHz)に基づく周期を持つ? 振幅スペクトル、パワ`スペクトル、位相スペクトルとも周期性を持つ称性?     吮净周波数(fs)が16kHzの信号のスペクトルは、8kHz(fs/2)を境に称? 振幅スペクトル、パワ`スペクトル、は8kHz(fs/2)を中心に折り返し? 位相スペクトルは8kHz  (fs/2)を中心に折り返し、正を反基本スペクトル周波数I域に射影完了0Hz                    16kHz                    32kHz【土】スペクトルの特(3)スペクトル上でのエイリアシング?   アナログ信号の最大周波数(fh)と吮净周波数fsのvS○            最大周波数(fh)  ＜  吮净周波数(fs) / 2【土】エイリアシング策エイリアシングを回避するために、?   必ずアナログ信号からデジタル信号にQするときは、を守する。?   予め吮净周波数fsがQまっている龊悉稀? アナログ信号にしてフィルタI理（後半のvxでh明予定）０                   fs/2                  fs3fs/22fsを行い、アナログ信号の最大周波数fhが吮净周波数の1/2以下になるように不要な周波数を除去する。× 折り返しがk生最大周波数(fh)  ＞  吮净周波数(fs) / 2? これにより、エイリアシングは回避可能? 一般的な音Sのレコ`ディングでは、音SCDの吮净周波 数fsが44100HzとQまっているので、レコ`ディングした音 信号にしてフィルタI理を行い、最大周波数fhが22050Hz 以下になるように不要な周波数を除去して音SCDをu作して いる。０            fs/2fs            3fs/22fs1【土】x散フ`リエQとはDiscrete Fourier Transform (DFT)フ`リエ数展_に基づく周波数解析法?   フ`リエ数展_：  （BA信号を⒍ǎ? すべての周期v数はsinとcosで表F可能【土】 x散フ`リエQにおけるスペクトル表x散フ`リエQx散信号と回子の内eの和で スペクトル解析可能?   x散フ`リエQ：  （x散信号を⒍ǎ? 基本スペクトル（0Hz～fs）の解析x散信号と回子の内eの和で スペクトル解析可能振幅スペクトル パワ`スペクトルg部                                虚部 位相スペクトル【土】 x散フ`リエQの性|（１）（２）周期信号を⒍à筏Q?     x散フ`リエQは有限L の信号をQ?     切り出した信号がRり返して【土】前回演n}(3/4)周期性x散rg信号       の１周期 (N=4) が下 の式で表せるとき、周波数解析をx散フ`リエQ を用いて行え1いる（周期信号である）と 定してスペクトルにQ?     よって非周期信号にして x散フ`リエQを行う 合には注意が必要。（gH の信号とはなったスペクト ルになる可能性あり）?? 1x(nT ) ? ?? 1(n ? 0,1)(n ? 2,3)0    1    2    3-1スペクトルは周期性?称 性を持つヒント：  x散フ`リエQの式に上を代入して 算するだけ（答えは}素数になることに注意！）【土】前回演n}(4/4)演n}(3/4)のスペクトル解析Y果を基に、振幅 スペクトル、パワ`スペクトル、位相スペクトルを 示せよ。（横Sは周波数もしくはkのとする。）【土】  前回演n}(4/4)解答例(1)(2)振幅スペクトルX(0) = 0 - j0X(0) = 0 - j0       X(1) = -2 - j(-2) X(2) = 0 - j0       X(3) = -2 - j2ヒント：  x散フ`リエQ式は下のように分解できる。 よって振幅スペクトルは？パワ`スペクトルは？  位相スペクトルは？8                               80               1              2              3X(1) = -2 - j(-2)X(2) = 0 - j0X(3) = -2 - j2kg部                                虚部k点でx散フ`リエQを行うとk/2を中心にスペクトルの称性がFれる。 振幅スペクトル、パワ`スペクトルの龊稀k/2を中心として折り返す形。2【土】前回演n}(4/4)解答例（3）演n}(1/4)位相スペクトルtan-1(-2/-2)=tan-1 (1)= π/4X(0) = 0 - j0X(1) = -2 - j(-2) X(2) = 0 - j0X(3) = -2 - j210Hzの正弦波にしてx散フ`リエQを用いて 周波数解析を行う龊稀⑶肖瓿訾骨gを(a)10波L、 (b)10.5波Lとすると、?   （１）  ２つのスペクトルは一致するか？?   （２）  （１）の理由は？0             1               2             3         ktan-1 (2/-2)=tan-1 (-1)= -π/4位相スペクトルの龊稀k/2を中心に折り返し、正を反した称性を持つヒント：  x散フ`リエQは周期v数を⒍à工搿Ｑ萘n}(1/4) 解答例10Hzの正弦波にしてx散フ`リエQを用いて 周波数解析を行う龊稀⑶肖瓿訾骨gを(a)10波L、 (b)10.5波Lとすると、?   （１）  ２つのスペクトルは一致するか？? 一致しない?   （２）  （１）の理由は？? x散フ`リエQは周期v数を⒍à工毪韦恰 (a)ならば10波LがRり返しk生するような信号を ⒍à贰(b)ならば10.5波Lで切り出した信号がRり返しk 生するような信号を⒍à瑜盲啤⑶肖瓿訾筏啃藕扭⒍à工胫芷谛藕扭なれ ば、スペクトルも当然なるので、２つのスペクトルは 一致しない。x散フ`リエQにおける スペクトル`差（１）x散フ`リエQにおける スペクトル`差（２）切り出し区gの`いによって、?   ⒍à工胫芷谛藕扭湫韦工搿＃ú贿BA点のk生）?   スペクトルも湫韦工搿?   下は切り出し区gの`いによる10Hzの信号にする パワ`スペクトル(a) 10波Lで切り出し                    (b) 10.5波Lで切り出し不BA点の除去に向けて不BA点について? あらかじめ、信号に含まれている波Lが既知であれば、 切り出し区gを{して不BA点を除去可能。? しかしながら、周波数解析するために信号を切り出す 合は、信号に含まれている周波数は未知のため不BA 点は必ずk生！? 信号の不BA点を除去しなければ正しい周波数解析は 行えない。どうすれば、不BA点を除去できるか？?   切り出した信号の最初と最後のが等しければ、切り出 した部分を周期とする周期信号とみなせる。?  v数の提案3v数とは信号の不BA点を除去するために提案されたv数?   v数は、Lい信号の中から一部を切り出すこと、「 を通して信号をQyする」ことがZ源?   このv数を使って信号を切り出すことで不BA点を除去?   下はv数の例v数のN切り出し区gが信号の整数倍のとき?   方形? 不BA点のI理は行わずgに信号を切り出すv数切り出し区gが信号の整数倍でないとき?   ハニング? 小さな周波数成分の分析に向いている?   ハミング? }数の周波数成分の分析や大きな周波数成分の分析に向いて いる。v数をどうxべばよいか？? gHの信号を切り出すときは整数倍で信号を切り出すこ とは不可能なため、ハニングやハミングでスペクトル `差を小さくすることが望ましい。v数の抗 (1)－切り出し区gが整数倍のとき－v数の抗 (2)`切り出し区gが非整数倍のとき`整数倍のときは方形を使うほうが正_にスペクトルを解析可能非整数倍のときはハニングを使うほうがスペクトルの精度が向上演n} (2/4)音Sのような}数の周波数を含む信号の 周波数解析を行う龊悉稀?  （１）  どのを用いて信号を切り出したほうが 良いか？?  （２）  その理由は？?  （３）  周波数解析においてv数を使うことの 欠点（}点）は？ヒント：  （１）、（２）は整数倍での切り出しが可能か？（３）はv数の形を良く考えて。演n} (2/4)  解答例１音Sのような}数の周波数を含む信号の周波数解 析を行う龊悉稀?  （１）  どのを用いて信号を切り出したほうが良い か？? 方形以外のハニングやハミングなど?  （２）  その理由は？? 音Sのような}数の周波数を含みかつ信号の 波Lが不明な龊悉稀⒎叫畏で切り出すと不 BA点がk生し、スペクトル`差が大きくなる。 よってハニングやハミングなどを使用して スペクトル`差をXpするのが望ましい。4演n} (2/4)  解答例２音Sのような}数の周波数を含む信号の周 波数解析を行う龊悉稀?  （３）  周波数解析においてv数を使うことの欠 点（}点）は？? v数をかけることにより信号自体が湫危à ずみ）をうけること。よってスペクトルはv数 による影を受け、若干の`差が生じる。しか し不BA点によるスペクトルの`差よりははる かに小さい。v数のまとめx散フ`リエQを用いた周波数解析?   不BA点の影によりスペクトルに`差がk生?   v数により、不BA点を除去してx散フ`リエQ を行えば、スペクトル`差を低p可能v数?   gHの信号を切り出すときは整数倍で信号を切り出 すことは不可能なため、ハニングやハミングが使 われる。? しかし、v数を使用することでスペクトルが湫韦 ることも注意が必要。（それでもv数を用いて不B A点を除去したほうがスペクトル`差は小さい）ヒント：  v数と切り出し区gのをかけて x散フ`リエQの式に代入して算するだけ演n}(3/4)x散rg信号 が下の式で表せるとき、x散 フ`リエQを用いて周波数解析を行いたい。切り 出し区gをn=0～3とし、下v数 を使って 周波数解析を行え。1                                                              1演n}(3/4) 大ヒント}素数虚Sj-2   -1-1n0    1    2     3    4    5n0     1    2    3-11           exp( 0 ) = 1exp( -j π/2) = -j1  (n= -2, -1, 2, 3 )-1 (n= 0, 1, 4, 5 )1 (n=1,2)0 (n=0,3)exp(-j π) = -1 exp(-j 3π/2) = j-j演n}(3/4) 解答例(1)X(0) =    WF(0) x(0) exp(-j 2π0 0/4)+ WF(1) x(1) exp(-j 2π1 0/4)+ WF(2) x(2) exp(-j 2π2 0/4)+ WF(3) x(3) exp(-j 2π3 0/4)=    0 ? (-1) exp(0) + 1 ? (-1)exp(0)+ 1? 1 exp(0) + 0 ? 1 exp(0)=    0 ? 1 + (-1) ? 1 + 1 ? 1 + 0 ? 1=    0 + (-1) + 1 + 0=    0 + j0以下同じようにX(1), X(2), X(3) を算すればよい。演n}(3/4) 解答例(2)X(1) =    WF(0) x(0) exp(-j 2π0 1/4) + WF(1) x(1) exp(-j 2π1 1/4)+ WF(2) x(2) exp(-j 2π2 1/4) + WF(3) x(3) exp(-j 2π3 1/4)=    0 ? (-1) exp(0) + 1 ? (-1)exp(-j  π/2)+ 1 ? 1 exp(-j π) + 0 ? 1 exp(-j 3π/2)=    0 ? 1 + (-1) ? (-j) + 1 ? (-1) + 0 ? j=    -1 + j1X(2) =    WF(0) x(0) exp(-j 2π0 2/4) + WF(1) x(1) exp(-j 2π1 2/4)+ WF(2) x(2) exp(-j 2π2 2/4) + WF(3) x(3) exp(-j 2π3 2/4)=     0 ? (-1) exp(0) + 1 ? (-1)exp(-j  π)+ 1 ? 1 exp(-j 2π) + 0 ? 1 exp(-j 3π)=    0 exp(0) + (-1)exp(-j  π) + 1 exp(0) + 0 exp(-j π)=    0 ? 1 + (-1) ? (-1) + 1 ? 1 + 0 ? (-1)=    2 + j05演n}(3/4) 解答例(3)X(3) =    WF(0) x(0) exp(-j 2π0 3/4) + WF(1) x(1) exp(-j 2π1 3/4)+ WF(2) x(2) exp(-j 2π2 3/4) + WF(3) x(3) exp(-j 2π3 3/4)=    0 ? (-1) exp(0) + 1 ? (-1)exp(-j 3π/2)+ 1 ? 1 exp(-j 3π) + 0 ? 1 exp(-j 9π/2)=    0 exp(0) + (-1)exp(-j 3π/2)+ 1 exp(-j π) + 0 exp(-j π/2)=    0 ? 1 + (-1) ? j + 1 ? (-1) + 0 ? (-j)=    -1 - j1よって、最K的な解答はX(0) =  0 - j0 (gに0でもOK)          X(2) =  2 - j0X(1) = -1 - j(-1)                           X(3) = -1 - j1演n}(4/4)演n}(3/4)のスペクトル解析Y果を基に、振幅 スペクトル、パワ`スペクトル、位相スペクトルを 示せよ。（横Sはk=0から8とする。）X(0) =  0 - j0          X(2) =  2 - j0X(1) = -1 - j(-1)      X(3) = -1 - j1ヒント：  x散フ`リエQ式は下のように分解できる。あとはスペクトル の称性と周期性を考]すれば…g部                                虚部演n}(4/4) 解答例（１）振幅スペクトル演n}(4/4) 解答例（２）パワ`スペクトル2                         22           2           2           2X(0) =  0 - j0X(1) = -1 - j(-1) X(2) =  2 - j0X(3) = -1 - j14                         42           2          2           2X(0) =  0 - j0X(1) = -1 - j(-1) X(2) =  2 - j0X(3) = -1 - j10     1    2    3k4     5    6    7    80     1    2    3k4     5    6    7    84点でDFTを行うと、K=2を中心にスペクトルの称性がFれる。 また、4点ごとにスペクトルの周期性がFれる。 前回の演n}のY果と比べるとv数の影がわかる。（なった部分がスペクトル`差となる）4点でDFTを行うと、K=2を中心にスペクトルの称性がFれる。 また、4点ごとにスペクトルの周期性がFれる。 前回の演n}のY果と比べるとv数の影がわかる。（なった部分がスペクトル`差となる）演n}(4/4) 解答例（３）位相スペクトル-1tan (-1/-1)=tan-1(1)= π/4tan-1(-1/-1)=tan-1(1)= π/4X(0) =  0 C j0X(1) = -1 - j(-1) X(2) =  2 - j0X(3) = -1 - j1k0     1    2    3    4     5    6    7    8tan-1(1/-1)=tan-1(-1)= -π/4tan-1(1/-1)=tan-1(-1)= -π/44点でDFTを行うと、K=2を中心にスペクトルの称性がFれる。また、4点ご とにスペクトルの周期性がFれる。位相スペクトルは前回の演n}のY 果比^してわかるように、v数の影を受けない。6デジタル信号I理第７回vxY料 （高速フ`リエQ）立命^大学 情罄砉ぱР  メディア情笱Э 李  亮２０１６．９．２６【土】スペクトルの特(1)(2)周期性?     吮净周波数(fs)が16kHzの信号のスペクトルは、基本スペクトル(0Hz-16kHz)に基づく周期を持つ? 振幅スペクトル、パワ`スペクトル、位相スペクトルとも周期性を持つ称性?     吮净周波数(fs)が16kHzの信号のスペクトルは、8kHz(fs/2)を境に称? 振幅スペクトル、パワ`スペクトル、は8kHz(fs/2)を中心に折り返し? 位相スペクトルは8kHz  (fs/2)を中心に折り返し、正を反基本スペクトル0Hz                    16kHz                    32kHz【土】スペクトルの特(3)スペクトル上でのエイリアシング?   アナログ信号の最大周波数(fh)と吮净周波数fsのvS【土】エイリアシング策エイリアシングを回避するために、?   必ずアナログ信号からデジタル信号にQするときは○            最大周波数(fh)  ＜  吮净周波数(fs) / 2                            、０                   fs/2                  fs3fs/22fsを守する。?   予め吮净周波数fsがQまっている龊悉稀? アナログ信号にしてフィルタI理（後半のvxでh明予定） を行い、アナログ信号の最大周波数fhが吮净周波数の1/2× 折り返しがk生最大周波数(fh)  ＞  吮净周波数(fs) / 2以下になるように不要な周波数を除去する。? これにより、エイリアシングは回避可能? 一般的な音Sのレコ`ディングでは、音SCDの吮净周波 数fsが44100HzとQまっているので、レコ`ディングした音 信号にしてフィルタI理を行い、最大周波数fhが22050Hz 以下になるように不要な周波数を除去して音SCDをu作して０            fs/2fs            3fs/22fsいる。【土】x散フ`リエQとはDiscrete Fourier Transform (DFT)フ`リエ数展_に基づく周波数解析法?   フ`リエ数展_：  （BA信号を⒍ǎ? すべての周期v数はsinとcosで表F可能【土】 x散フ`リエQにおけるスペクトル表x散フ`リエQx散信号と回子の内eの和で スペクトル解析可能?   x散フ`リエQ：  （x散信号を⒍ǎ? 基本スペクトル（0Hz～fs）の解析x散信号と回子の内eの和で スペクトル解析可能振幅スペクトル パワ`スペクトルg部                                虚部 位相スペクトル1x散フ`リエQの}点x散フ`リエQ?  Nを大きくすればスペクトル解析精度は向上?  しかし、Nが大きくなると算量は膨大?  算rgがかかるとシステムの荷大?  高速フ`リエQの提案高速フ`リエQ高速フ`リエQとは?   FFT: Fast Fourier Transform?   スペクトル解析を高速に行うためのアルゴリズム?   x散フ`リエQと高速フ`リエQのスペクトルは同じ高速フ`リエQの特?   スペクトル解析のための算回数/rgを削p?   解析Y果は、x散フ`リエQと同じ?   算rgを短s可能p?   ただし、デ`タ数は  N = 2  という制sあり?   算量は2? x散フ`リエQ<Ｏ（N ）>? 高速フ`リエQ<Ｏ（N log2 N）>演n}(1/1)x散フ`リエQ(DFT)の算回数をN2、高 速フ`リエQ(FFT)の算回数をN log2 N としたとき、下の算回数表を埋めよ。デ`タ数Ｎ     DFT        FFT      DFT/FFT32            ?             ?            ?64            ?             ?            ?128            ?             ?            ?256            ?             ?            ?演n}(1/1) 解答例（１）x散フ`リエQ(DFT)の算回数をN2、高速フ` リエQ(FFT)の算回数をN log2 Nとしたとき、下 の算回数表を埋めよ。N=32のとき( N = 32 = 2  ) DFT(N2): 25 * 25 =210  = 1024FFT(Nlog N): 32 log  25 = 32 * 5 = 160DFT/FFT: 1024/160 = 6.4N=256のとき( N = 256 = 28 ) DFT(N2 ): 28 * 2 8 =216 = 65536FFT(Nlog2N): 256 log 2 2 = 256 * 8 = 2048DFT/FFT: 65536/2048 = 32ヒント: N=32= 25よってlog 2 N は?演n}(1/1) 解答例（２）x散フ`リエQ(DFT)の算回数をN2、高速フ` リエQ(FFT)の算回数をN log2 Nとしたとき、下 の算回数表を埋めよ。FFTへの道のりどうやって高速にフ`リエQをgFするか？?   Iとなるのは回子デ`タ数Ｎ     DFT        FFT      DFT/FFT32          1024       160          6.464          4096       384         10.7128         16384       896         18.3256         65536      2048         32デ`タ数Nがえるにつれて、FFTはDFTよりも より高速な演算が可能。（例：N=256ならFFTはDFTより32倍速い）?   この回子         の性|が算量削pの大きな役割を 果たす2回子      の性|?  周期性：? 回子は周期Ｎのv数。よって任意のpにして(1)?  指数\算の性|：? p<mである任意のpにしてDFTアルゴリズム?   N=4とすると?   K=0,1,2,3として行列を使って展_すると(2)? N/2Mめると符号が反させたものと等しくなる(3)?   デ`タ数をNとするとe和演算回数はN2 回となるＦＦＴアルゴリズム（１）ポイントはデ`タ分割と回子の特?   デ`タ分割することで柯胜瑜Qを行う? ソ`トアルゴリズムであれば、?   バブルソ`トのようなt当りのアルゴリズムがDFT?   クイックソ`トのようなデ`タ分割型のアルゴリズムがFFT? と同じ考え方である?   デ`タ分割のポイント? デ`タを分割することでデ`タLＮをかけ上、小さくしてDFTをRり返し行う。? 例えばＮ＝32点のとき?   N=32点のDFTの算回数は1024回?   デ`タ分割して例えば16点のDFTを2回行うとN=16点のDFTの 算回数は256回(N 2 )なので、算回数は256  × 2 = 512回?   gHにはＮをできるだけ小さく分割して、あとからマ`ジする。FFTアルゴリズム（２）FFTの基本的な流れ?  基本はデ`タ分割（偶数番と奇数番で分割）FFTアルゴリズム（３）FFTアルゴリズム（４）デ`タ列デ`タ列: x(n)スペクトル:X (k )（rg波形）x(n)0   1   2   3   4   5   6   7偶数番列:x0 (n)奇数番列: x1 (n)偶数スペクトル: X 0 (k )奇数スペクトル: X 1 (k )x0 (n)x1 (n)?X (k ) ? ? X?0 (k ) ? e? j 2? kN?X 1 (k )  ??0        2        4        6                             1        3        5        7?               ? j 2? k                      ?偶数番列奇数番列X ( N ? k ) ? ? X0 (k ) ? eN     X 1 (k )  ?rg波形を偶数番と奇数番で２つの系列に分解 すると、スペクトルは次ペ`ジのように表せる。 このとき必ずデ`タ列は  N =  p の必要あり。2             ?                                    ?3FFTアルゴリズム（５）2?FFTアルゴリズム（６）?          ?  ? j     k                     ??                  ?                    ?                                          ?X (k ) ? ?X 0 (k )   eN    X1 (k )  ?? j   ×0?               ? j   ×0             ??                                  ?                                    X (0) ?2?? X 0 (0) ? e?2    X1 (0)???X (2) ?? X 0 (0) ? e   2??X1 (0)??N            ?          ?  ? j      k                     ??              ? j   ×1            ???              ? j   × 1          ??               ?X (    ? k ) ? ?X 0 (k )   e2            ?N    X1 (k )  ??X (1) ?? X 0 (1)?e   2   X1 (1)??X (3)? X 0 (1)?e   2   X1 (1)??式より、Ｎ＝４とするとスペクトルは?               ? j ? ×0             ??               ? j ? ×0             ?Y果、算回数はデ`タ数をＮとするとX (0) ?? X0 (0) ? e?2    X1 (0)??X (2) ?? X 0 (0) ? e?2    X1 (0)???  ＦＦＴのe和演算回数?              ? j   ×1            ??              ? j   × 1          ??  DFTのe和演算回数X (1) ?? X0 (1) ? e?2   X1 (1)??X (3) ?? X 0 (1) ? e?2   X1 (1)??ポイント：  分割をRり返し行い、同じをRり返し使う形にする?  一般的に通常のスペクトル解析にはFFTを使うFFTのまとめ高速フ`リエQの特?   スペクトル解析を高速かつ少ない演算量で行える。?   ポイントはデ`タ系列の分解と回子の有坷用? FFTはデ`タLを分割して短いデ`タLのDFTを}数回行うこ とで高速化をgF（FFTはDFTの暧茫?   ただしデ`タLは  N = 2p の必要がある。? もし2p でなければ、0付加（ゼロめ）してデ`タLを 2p にする?   通常のスペクトル解析ではFFTを使用する。? gHの商品にもFFTアルゴリズムが使用されていることが多い?   FFTもスペクトル解析手法の１つなので、欷堡胜嗓 行い、不BA点の影を除去する必要あり。? DFTもFFTもアルゴリズムがなるだけでY果は同じ? よって算出したスペクトルも同じ4デジタル信号I理第８回vxY料 （x散rg信号系）立命^大学 情罄砉ぱР  メディア情笱Э 李  亮２０１６．９．２７本日のvx内容x散rg信号系?  系とは?  形r不湎?  インパルス甏鹣惦x散rg信号系系とは?  英Z表はsystem(システム)?  「々な要素を持つ体系」身近な系?  例えば子レンジ? 冷えたごを入力すると、温めるという浠を加え、 温かいごを出力するシステム。形系（形システム）信号           をシステムL に入力したときの出 力を           とする?   このシステムが「重ね合わせの原理」を氦郡工趣 形系（形システム）と呼ぶご                  （子レンジ）                      温かいご上２つをまとめると重ね合わせの原理（１）２つの信号の和を入力したとき重ね合わせの原理（２）a倍した信号を入力したとき1演n}（1/4）次のシステムは形システムか？形システム である龊悉悉饯卫碛嗓饪激à琛?   １．システムＬが５を足す系の龊? 例えば入力に２を入れると出力は７になる系?   ２．システムＬが３をかける系の龊? 例えば入力に２を入れると出力は６になる系?   ３．システムＬが入力の２\を行う系の龊? 例えば入力に３を入れると出力は９になる系演n}（1/4）  解答例1次のシステムは形システムか？形システムである 合はその理由も考えよ。?   形システムかどうかは重ね合わせの原理を氦郡 かどうかでQまる。?     １．システムＬが5を足す系の龊暇形システムではないヒント：形システムの条件は？? L{2} + L {3} = (2+5) + (3+5) = 15? L{ 2 + 3 } = (5+5) = 10? L{2} + L{3} ≠ L{2 + 3}?   重ね合わせの原理（１）を氦郡丹胜ぱ萘n}（1/4）  解答例２演n}（2/4）?   ２．システムＬが３をかける系:形システムであるフ`リエQは形システムか？形システム? L{2} + L {3} = (2×3) + (3×3) = 15? L{ 2 + 3 } = (5×3) = 15? L{2} + L{3} ＝ L{2 + 3} (重ね合わせの原理（１）を氦郡)? L{ 2×3 } = 6 × 3 = 18? 2 L{3} = 2 × (3×3) = 18? L{a×2} = aL{2}   (重ね合わせの原理（２）も氦郡)ヒント：の龊稀その理由も考えよ。?   ３．システムＬが入力の２\を行う系:形システムではない? L{2} + L {3} = (2×2) + (3×3) = 13? L{ 2 + 3 } = (5×5) = 25? L{2} + L{3} ≠ L{2 + 3}? 重ね合わせの原理（１）を氦郡丹胜い长问饯して形システムの条件を当てはめると？演n}（2/4）  解答例よって、重ね合わせの原理を氦郡咕形r不浈伐攻匹嗑形r不浈伐攻匹啶趣?   形システムの特性がrgによって浃铯椁胜ぅ伐攻匹?   信号        のrgを m サンプル分シフトした信号 を入力したとき、システム出力がとなれば形r不浈伐攻匹啶扦る?   身近な例：? ステレオのアンプなど?   もしステレオのアンプが形r不浃扦胜い去堀辚濠`ムの大きさがrg とともに浠してしまい、自分でボリュ`ムの大きさを制御できなくなる。2形r不浈伐攻匹啶翁跫                    インパルス（１）システムの表F方法としてインパルス甏黏蚴工 のが一般的?   インパルスとは（x散rg系）インパルス（２）インパルスのまとめ： x散rg系でのインパルス         は n=0 でのみ、高さが１となるv数インパルスを用いた信号の表F（１）インパルスを用いた信号の表F?  信号        { n = 0, 1, 2, … , N-1 } をインパ ルスを用いて表すと式を分解するとデジタル信号は加重S数        と、シフトされた インパルス               の形Y合として表Fできるインパルスを用いた信号の表F（２）インパルスを用いた信号の表Fインパルス甏馥ぅ螗靴毳甏黏趣?  形r不浈伐攻匹啶衰ぅ螗靴毳      を入力した とき、その出力        をインパルス甏黏群簸证猡趣涡藕         をrgシフトしS数倍した インパルスの和に分解して表F可能rgを２サンプル分シフトし、 大きさをx(2)倍したインパルスよってmサンプル分シフトしたインパルスにする出力は、 形r不湎丹涡再|より3形r不浈伐攻匹啶伪碛法（１）形r不浈伐攻匹啶稳氤隽vS形r不浈伐攻匹啶伪碛法（２）X(n)をインパルスを用いた式で表F重ね合わせの原理（１）より重ね合わせの原理（２）よりインパルス甏黏问饯瑜辘长欷颏郡郡撙长吆亭趣瑜酉掠のように表F＊は普通の欷彼悚扦悉胜い韦且注意これより形r不浈伐攻匹啶纬隽Δ稀⑷肓Δ去ぅ螗靴毳甏黏 たたみこみ和で求められる演n}（3/4）形r不浈伐攻匹啶摔いて入力       、 インパルス甏       が下のように与えら れたときの出力      を求めよ。x(0) = 4    x(1) = 3 x(2) = -2   x(3) = 1 x(4) = -1   x(5) = 2ヒント：  みzみ和の式に当てはめるだけ演n}（3/4）  解答例１形r不浈伐攻匹啶摔いて入力       、インパルス甏 が下のように与えられたときの出力       を求めよ。y(0) =     x(0)h(0-0) + x(1)h(0-1) + x(2)h(0-2)+ x(3)h(0-3) + x(4)h(0-4) + x(5)h(0-5)=   4×0 + 3×0 + (-2)×0 + 1×0 + (-1)×0 + 2×0=   0y(1) =   x(0)h(1-0) + x(1)h(1-1) + x(2)h(1-2)+ x(3)h(1-3) + x(4)h(1-4) + x(5)h(1-5)=   4×0 + 3×0 + (-2)×0 + 1×0 + (-1)×0 + 2×0=   0演n}（3/4）  解答例2y(2) =   x(0)h(2-0) + x(1)h(2-1) + x(2)h(2-2)+ x(3)h(2-3) + x(4)h(2-4) + x(5)h(2-5)=   4×1 + 3×0 + (-2)×0 + 1×0 + (-1)×0 + 2×0=   4y(3) =   x(0)h(3-0) + x(1)h(3-1) + x(2)h(3-2)+ x(3)h(3-3) + x(4)h(3-4) + x(5)h(3-5)=   4×0 + 3×1 + (-2)×0 + 1×0 + (-1)×0 + 2×0=   3y(4) =   x(0)h(4-0) + x(1)h(4-1) + x(2)h(4-2)+ x(3)h(4-3) + x(4)h(4-4) + x(5)h(4-5)=   4×0 + 3×0 + (-2)×1 + 1×0 + (-1)×0 + 2×0=   -2演n}（3/4）  解答例3y(5) =   x(0)h(5-0) + x(1)h(5-1) + x(2)h(5-2)+ x(3)h(5-3) + x(4)h(5-4) + x(5)h(5-5)=   4×0 + 3×0 + (-2)×0 + 1×1 + (-1)×0 + 2×0=   1y(6) =   x(0)h(6-0) + x(1)h(6-1) + x(2)h(6-2)+ x(3)h(6-3) + x(4)h(6-4) + x(5)h(6-5)=   4×0 + 3×0 + (-2)×0 + 1×0 + (-1)×1 + 2×0=   -1y(7) =   x(0)h(7-0) + x(1)h(7-1) + x(2)h(7-2)+ x(3)h(7-3) + x(4)h(7-4) + x(5)h(7-5)=   4×0 + 3×0 + (-2)×0 + 1×0 + (-1)×0 + 2×1=   24演n}（3/4）  解答例4Ans.y(0) = 0, y(1) = 0, y(2) = 4, y(3) = 3, y(4) = -2, y(5) = 1, y(6) = -1, y(7) = 2,演n}（4/4）形r不浈伐攻匹啶摔いて入力       、 インパルス甏      が下のように与えら れたときの出力      を求めよ。ポイント： このケ`スではh(n)がn=2のときのみ１、それ以外は０なので、 入力信号xを2点ずらした出力となる。X(0) = 4    X(1) = 3X(2) = -2   X(3) = 1X(4) = -1   X(5) = 2h(0) = 2,   h(2) = 1 n=0,2以外 h(n) = 0ヒント：  みzみ和の式に 当てはめるだけ演n}（4/4）  解答例１形r不浈伐攻匹啶摔いて入力       、インパルス甏 が下のように与えられたときの出力       を求めよ。y(0) =   x(0)h(0-0) + x(1)h(0-1) + x(2)h(0-2)+ x(3)h(0-3) + x(4)h(0-4) + x(5)h(0-5)=   4×2 + 3×0 + (-2)×0 + 1×0 + (-1)×0 + 2×0=   8y(1) =   x(0)h(1-0) + x(1)h(1-1) + x(2)h(1-2)+ x(3)h(1-3) + x(4)h(1-4) + x(5)h(1-5)=   4×0 + 3×2 + (-2)×0 + 1×0 + (-1)×0 + 2×0=   6演n}（4/4）  解答例2y(2) =   x(0)h(2-0) + x(1)h(2-1) + x(2)h(2-2)+ x(3)h(2-3) + x(4)h(2-4) + x(5)h(2-5)=   4×1 + 3×0 + (-2)×2 + 1×0 + (-1)×0 + 2×0=   4 + (-4) = 0y(3) =   x(0)h(3-0) + x(1)h(3-1) + x(2)h(3-2)+ x(3)h(3-3) + x(4)h(3-4) + x(5)h(3-5)=   4×0 + 3×1 + (-2)×0 + 1×2 + (-1)×0 + 2×0=   3 + 2 = 5y(4) =   x(0)h(4-0) + x(1)h(4-1) + x(2)h(4-2)+ x(3)h(4-3) + x(4)h(4-4) + x(5)h(4-5)=   4×0 + 3×0 + (-2)×1 + 1×0 + (-1)×2 + 2×0=   -2 + (-2) = (-4)演n}（4/4）  解答例3y(5) =   x(0)h(5-0) + x(1)h(5-1) + x(2)h(5-2)+ x(3)h(5-3) + x(4)h(5-4) + x(5)h(5-5)=   4×0 + 3×0 + (-2)×0 + 1×1 + (-1)×0 + 2×2=   1 + 4 = 5y(6) =   x(0)h(6-0) + x(1)h(6-1) + x(2)h(6-2)+ x(3)h(6-3) + x(4)h(6-4) + x(5)h(6-5)=   4×0 + 3×0 + (-2)×0 + 1×0 + (-1)×1 + 2×0=   -1y(7) =   x(0)h(7-0) + x(1)h(7-1) + x(2)h(7-2)+ x(3)h(7-3) + x(4)h(7-4) + x(5)h(7-5)=   4×0 + 3×0 + (-2)×0 + 1×0 + (-1)×0 + 2×1=   2演n}（4/4）  解答例4Ans.y(0) = 8, y(1) = 6, y(2) = 0, y(3) = 5, y(4) = -4, y(5) = 5, y(6) = -1, y(7) = 2,h(0) = 2入力信号xを２倍＝       ＋   h(2) = 1入力信号xを2点シフトポイント：このケ`スではh(n)がn=0のとき２、n=2のとき１、 それ以外は０なので、入力信号xを２倍した信号と入力信号xを2点ずらした信号を足し合わせた信号が出力となる。5デジタル信号I理第９回vxY料 （ ＺQ ）立命^大学 情罄砉ぱР  メディア情笱Э 李  亮２０１６．９．２７本日のvx内容【土】前回vxの土?   x散rg信号系? 形r不湎? インパルス甏穑Q?   たたみこみ演算の考え方?   ＺQとは?   システムの贿_v数?   ＤＦＴとＺQ【土】x散rg信号系系とは?  英Z表はsystem(システム)?  「々な要素を持つ体系」身近な系?  例えば子レンジ? 冷えたごを入力すると、温めるという浠を加え、 温かいごを出力するシステム。【土】形系（形システム）信号           をシステムL に入力したときの出 力を           とする?   このシステムが「重ね合わせの原理」を氦郡工趣 形系（形システム）と呼ぶご                  （子レンジ）                      温かいご上２つをまとめると【土】形r不浈伐攻匹嗑形r不浈伐攻匹啶趣?   形システムの特性がrgによって浃铯椁胜ぅ伐攻匹?   信号        のrgを m サンプル分シフトした信号 を入力したとき、システム出力がとなれば形r不浈伐攻匹啶扦る?   身近な例：? ステレオのアンプなど?   もしステレオのアンプが形r不浃扦胜い去堀辚濠`ムの大きさがrg とともに浠してしまい、自分でボリュ`ムの大きさを制御できなくなる【土】インパルス甏馥ぅ螗靴毳甏黏趣?  形r不浈伐攻匹啶衰ぅ螗靴毳      を入力した とき、その出力        をインパルス甏黏群簸证瑜盲mサンプル分シフトしたインパルスにする出力は、 形r不湎丹涡再|より1【土】 形r不浈伐攻匹啶伪碛法形r不浈伐攻匹啶稳氤隽vSX(n)をインパルスを用いた式で表Fたたみこみ和の考え方たたみこみ和演算とは?  信号をW延させてあるS数を与えて次々に加 算していく算重ね合わせの原理（１）より重ね合わせの原理（２）よりインパルス甏黏问饯瑜辘长欷颏郡郡撙长吆亭趣瑜酉掠のように表F＊は普通の欷彼悚扦悉胜い韦且注意直接、式を算しなくても、h(0)=2, h(2)=1ということは、０r刻 信号をW延させて振幅を２倍したものと、２r刻信号をW延させて 振幅を１倍したものを足し合わせればＯＫたたみこみ和演算のg例（１）たとえば、部屋の反射など? スピ`カから音を出力すると、人gの耳には直接音が 到着してからちょっとWれて反射音が届く。これを式で くとたたみこみ和になる。たたみこみ和演算のg例（２）スピ`カから出力する音             部屋のインパルス甏馥攻冤`カから出力する音             部屋のインパルス甏                                             ＋                   ＝この系だと、スピ`カから出力された音は、０サンプル（０r刻）後に直接音が振幅が２倍されて到着するのにし反射音は２サンプル（２r刻）後に振幅が１倍されて到着するという意味になる。０サンプル（０r刻）後に 直接音が振幅が２倍され て到着反射音は２サンプル（２r刻）後に振幅が１倍されて到着Qy信号： x(n)という音をスピ`カから 出力しても我々の耳に到着するときには 反射音などの影により信号が湫窝萘n}(1/4)ある部屋でインパルス甏黏蛴yしたY果、下 を得た。このインパルス甏黏颏猡趣瞬课荬谓馕訾蛐肖い郡ぁ￥郡坤伐单螗抓辚螗爸懿ㄊを8000Hz、 音速を340m/sとする。?   １．  信号源（インパルスk生源）とQy点の距xは？?   ２．  反射音は直接音と比べて、どのくらいWれて、どのく らいのパワ`（エネルギ`）で到着するか？ヒント：  距x＝速さ×rg１．は原点から直接音到着 までのr刻でQまる。２．は直接音と反射音のr刻差とパワ`差でQまる演n}(1/4) 解答例(1)ある部屋でインパルス甏黏蛴yしたY果、下h(n)を得た。このインパルス 甏黏颏猡趣瞬课荬谓馕訾蛐肖い郡ぁ￥郡坤伐单螗抓辚螗爸懿ㄊを8000Hz、音 速を340m/sとする。?   １．  信号源（インパルスk生源）とQy点の距xは？? 距x＝速さ×rg? 信号源からQy点の距x＝音速×原点から直接音到着ま でのrg? 音は直接音が一番最初に到_するから? 340m/s ×  (1 × 1/8000Hz) = 0.0425 m?  Ans.：  0.0425 m2演n}(1/4) 解答例(2)ある部屋でインパルス甏黏蛴yしたY果、下h(n)を得た。このインパルス甏黏颏 とに部屋の解析を行いたい。ただしサンプリング周波数を8000Hz、音速を340m/s。２．反射音は直接音と比べて、どのくらいWれて、どのくらいのパ ワ`（エネルギ`）で到着するか？?   ①直接音到着から反射音到着までのrgを算する? ( (4 - 1) × 1/8000Hz) = 0.000375 sec.? Ans.：  0.375 msec. (=0.000375sec)?   ②直接音と反射音のパワ`差を算する? 直接音の振幅１、反射音の振幅0.5? パワ`（エネルギ`）は振幅の２\（物理のとおり）? 直接音のパワ` ： 反射音のパワ`? ＝  (1) : (0.5)  ＝  1 : 0.25? Ans.: 直接音の1/4のパワ`で到着形r不湎丹韦蓼趣峋形r不湎?   インパルス甏黏摔瑜晗丹虮憩F可能?   インパルス甏黏わかっていれば、音源情螭趣韦 たみこみ和演算によりQy信号を推yできる。?   インパルス甏黏あれば、その系の解析も行うことが できる。非形系?   インパルス甏黏悉饯韦蓼奘工à胜?   なぜなら音源情螭去ぅ螗靴毳甏黏虍みzんでも、 gHにQyした信号と同一になるとは保障されない から。演n}(2/4)身の回りの系（h境）で下のものを理由も 含めて考えよ。?  １．  形r不湎? 例えば、温度など，他には？?  ２．  形r湎? 例えば、土地の段など、他には？?  ３．  非形系? 世の中の多くは非形系。考えてみてください? 例えば、航空料金など演n}(2/4) 解答例１身の回りの系（h境）で下のものを理由も含めて考えよ。? １．  形r不湎?例えば、温度など、理由は菸陇２倍 になると温度のも２倍になり、温度の 合は温度の合と一致するので、 重ね合わせの原理を氦郡工ら形。ま た明日温度をっても同じ菸陇扦れば 温度のは同じなので、r不浃扦る。演n}(2/4) 解答例２身の回りの系（h境）で下のものを理由も含めて考えよ。? ２．  形r湎?例えば、土地の段など、理由は土地 の面eが２倍になれば土地の段も 大体２倍になる。また土地の面eの合 は土地の段の合と一致する ので、重ね合わせの原理を氦郡工ら 形。ただし、１年後、同じ土地の面e にする格は同じとは限らないので r浃扦る。演n}(2/4) 解答例３身の回りの系（h境）で下のものを理由も含めて考えよ。? ３．  非形系?例えば、航空料金など、理由は距xが２ 倍になっても料金は２倍にならない。リ ゾ`トホテルの料金は２倍Bっても２倍 のサ`ビスになるとは限らない。プロ野 球x手の年俸が２倍になっても、成は２倍にならない。?世の中の大半は非形。3ＺQＺQとは?  rgSの信号          から}素平面（Ｚ平面）上 への写像? zは}素数であるＺQの性|（１）①重ね合わせの原理が成り立つ?  よって必ず形r不湫预成り立つ②たたみこみ和のＺQはＺQのeになる形r不浈伐攻匹啶 周波数特性を表すのにmすrgSの演算Z平面上での演算この２式は同じ 演算を意味するＺQの性|（２）③rgがmサンプル分シフトした信号のＺQは となる?   信号           をmサンプル分シフトさせた信号                の ＺQは                 となる④周波数特性は  z を                で置き替えればよい?   x(n)のＺQをX(z)とするとき  z=                  とおくと、 は周波数ｆのv数となるから、信号の周波数特性を求めることができる 。      は吮净g隔を示す。ＺQを用いた周波数特性（１）形r不浈伐攻匹啶纬隽?  IxをＺQすると、ＺQの性|②より?  式を湫韦工毪趣趣胜辚ぅ螗靴毳甏  h(n)のZQ H(z)が形シ ステムの周波数特性を表し、このH(z)をシステム の贿_v数（システムの贿_特性）とよんでいる。ＺQを用いた周波数特性（２）贿_v数?  ＺQの性|④よりシステムの周波数特性はｚを と置き替えるだけ演n}(3/4)信号の微分を行ったり、画像I理で郭を{するのに、入 力信号のO接した吮の差を出力信号とする手法が良く 用いられる。ここで入力信号をx(n)、出力信号をy(n)とすると周波数fのv数? 周波数特性は}素数なのでg部と虚部をとすると 振幅特性位相特性?   １．この式のIxをＺQせよ?   ２．システムの贿_v数を求めよ?   ３．システムの周波数特性を求めよ。? ただし吮净g隔は     とする。?   ４．システムの振幅特性と位相特性を求めよ。ヒント：ＺQの式にを代入するだけ4演n}(3/4) 解答例（１）１．この式のIxをＺQせよ? ＺQの性|③を使うと、２．システムの贿_v数を求めよ。演n}(3/4) 解答例（２）３．システムの周波数特性を求めよ。?ＺQの性|④より、z=                   とおくと４．システムの振幅特性と位相特性を求めよ。?振幅特性：?位相特性：演n}(4/4)ＤＦＴによりQしたスペクトルのＺ平面上 でのEを考える。演n}(4/4) 解答例kの浠にするX(k)のＺ平面上でのEは？とすると?  x散信号 x(n){n=0,1,2,3,…,N-1}のx散フ `リエQはここで                  とおいたとき、kの浠に するX(k)のＺ平面上でのEを硎兢护琛％谣螗龋DFTのスペクトルはx散。よって Ｚ平面の？？でg隔？の点がEになる。左の恧韦瑜Δ摔胜搿k=0のときz=exp(0) = 1 k=1のときz=exp(j2π/N)                              k=k1のときz=exp(j2πk1 /N)                    Ans: Ｚ平面のg位 上でg隔2π/Nの点が Eとなる5デジタル信号I理第１０回vxY料（デジタルフィルタと利得（デシベル））立命^大学 情罄砉ぱР  メディア情笱Э 李  亮２０１６．９．２９本日のvx内容【土】前回vxの土?   ＺQ? ＺQとは? システムの贿_v数ＺQと逆ＺQ?   逆ＺQとはデジタルフィルタと利得?   デジタルフィルタとは?   利得（デシベル）とは【土】ＺQＺQとは?  rgSの信号          から}素平面（Ｚ平面）上 への写像? zは}素数である【土】ＺQの性|（１）①重ね合わせの原理が成り立つ?  よって必ず形r不湫预成り立つ②たたみこみ和のＺQはＺQのeになる形r不浈伐攻匹啶 周波数特性を表すのにmすrgSの演算Z平面上での演算この２式は同じ 演算を意味する【土】ＺQの性|（２）③rgがmサンプル分シフトした信号のＺQは となる?   信号           をmサンプル分シフトさせた信号                の ＺQは                 となる④周波数特性は  z を                で置き替えればよい?   x(n)のＺQをX(z)とするとき  z=                  とおくと、 は周波数ｆのv数となるから、信号の周波数特性を求めることができる 。      は吮净g隔を示す。【土】 ＺQを用いた周波数特性（１）形r不浈伐攻匹啶纬隽?  IxをＺQすると、ＺQの性|②より?  式を湫韦工毪趣趣胜辚ぅ螗靴毳甏  h(n)のZQ H(z)が形シ ステムの周波数特性を表し、このH(z)をシステム の贿_v数（システムの贿_特性）とよんでいる。1【土】 ＺQを用いた周波数特性（２）贿_v数?  ＺQの性|④よりシステムの周波数特性はｚを と置き替えるだけ周波数fのv数演n}(1/5)下のx(n)とx(n-1)のZQを求めよ。1          11      x(n)            1                         n0          2-1? 周波数特性は}素数なのでg部と虚部をとすると 振幅特性位相特性1          12   x(n ? 1)                2                   n0    1          3-1ヒント：  ＺQの公式に当てはめるだけ演n}(1/5) 解答例（１）x(n)のZQは、演n}(1/5) 解答例（２）x(n-1)のZQは、1          11          1x(n)            1                         nx(n ?1)2                   n0    1          30          2                                                                                                                    -1-1?Z ?x(n)?? ? x(n) z ? nZ ?x(n ?1)?? x(0) ? x(1) z ?1 ? x(2) z ?2 ? x(3) z ?3 ?  …n ?0? x(0) ? x(1) z ?1 ? x(2) z ?2 ? x(3) z ?3 ?   …? z ?1?1? z ?2? z ?3? 1 ? z ?1 ? z ? 2? z  ? Z[ x(n)]演n}(2/5)下のx(n)＋x(n-1)のZQを求めよ。1                1演n}(2/5) 解答例x(n)＋x(n-1)のZQは、1                1x(n) ? x(n ? 1)0    1    2    3             nx(n) ? x(n ? 1)0    1    2    3             nヒント：  ＺQの公式に当てはめてもできるが、 演n}(1/5)のY果とＺQの性|①（ＺQの形性）を用いるとgに算可能Z ?x(n) ? x(n ?1)?? 1 ? z ?3? (1 ? z ?1  ? z ?2)?(z ?1 ? z ?2 ? z ?3 )? Z[ x(n)] ? Z ?x(n ?1)?2演n}(3/5)下のx(n)とx(n-1)のたたみこみ和をＺQ を用いて求めよ。演n}(3/5) 解答例(1)x(n)とx(n-1)のたたみこみ和はＺQを用いると、1          1                                          1          11                                                       2                   n1          1                                          1          11                         n                     2                   nn0          2-1         x(n)0    1          3-1x(n ? 1)0          2-1         x(n)0    1          3-1x(n ? 1)Z ?x(n) ? x(n ?1)? ? X (Z ) ? z ?1 X ( z)ヒント：  演n}(1/5)のY果とＺQの性|②（たたみこ み和のＺQはＺQのe）を用いるとgに算可能?? (1 ? z ?1 ? z ?2 )( z ?1 ? z ?2 ? z ?3 )? z ?1 ? 2z ?2 ? 3z ?3 ? 2z ?4 ? z ?5演n}(3/5) 解答例(2)逆ＺQＺQとはx(n)ｚQ逆ｚQX ( z)?  rgSの信号 x(n)から}素平面（Ｚ平面）上Z ?x(n) ? x(n ?1)? ? z ?1 ? 2z ?2 ? 3z ?3 ? 2z ?4 ? z ?5への写像?X ( z) ? ? x(n)z ? nn?03                                                                              逆ＺQとは1                        1                                                                    ?  }素平面（Ｚ平面）上のスペクトルX(z)からr2          4                       ngS上の信号への写像0    1          3           5-2        -2x(n) ?12?jX ( z) z n?1dz?ただし、gHに逆ＺQをこの式を用いて行うことはめったにない。 ＺQの逆Qがあることだけえておけばよい。デジタルフィルタフィルタとは?   々なものの中から、不要なものを除去して必要なも のを取り出す回路?   例：叱Cやエアコンのフィルタ? これらはアナログフィルタデジタルフィルタとは?   色々な周波数成分を持つ信号の中から、不要な周波 数成分を除去し、必要な周波数成分のみを取り出す 回路?   例：ステレオのドルビ`C能? j音を抑Rしたり、音を{したりするC能理想的なデジタルフィルタとは必要な信号をきれいに取り出すために?   信号の大きさが浠しない? 通^域の利得がフラット?   波形が浠しない? ひずみがゼロ?   余な信号を付加しない? ノイズがない?   キ`ポイントは所望の信号に歪を与えないようにすること不要な信号をきれいに取り除くために?   不要な周波数・扦侠得がゼロ? p衰域の利得がゼロ?   キ`ポイントは不要な信号はゼロにすること3デジタルフィルタの基本特性デジタルフィルタの特性デジタルフィルタのNは４Nに分低域通^フィルタ高域通^フィルタ∮蛲ㄟ^フィルタ∮蜃柚攻榨％毳骏ットオフ周波数                                       カットオフ周波数(low pass filter:LPF)(high pass filter:HPF)  (band pass filter:BPF) (band stop filter:BSF)カットオフ周波数振幅が、 1/   2となる周波数をさすこれをdB表でくと  3dBp衰した周波数となるデジタルフィルタにvする用Z通^域?   フィルタで取り出したい信号の周波数∮p衰域?   フィルタで除去したいGain低域通^フィルタのO理想的な低域通^フィルタ?   低域だけをきれいに取り出す?   高域の利得はゼロ? ?  非常にOがyしいGain通^域         p衰域信号周波数∮蛘诙现懿ㄊ（カットオフ周波数）?   遮断周波数通^域と 遮断域の境界の周波数次数?   理想特性を近似するv数の 次数で高い（大きい）ほど理想に近い通^域         p衰域遮断周波数例：LPF一般的な低域通^フィルタ?   遮断周波数で完全に利得を ゼロにできない?   用途に合わせて々な低域通^ フィルタのO方法がある遮断周波数低域通^フィルタのNと特性バタワ`スフィルタ?   通^域をフラットにすることを重? 一般的なフィルタベッセルフィルタ?   立ち上がり特性を最mにする? ^渡甏鹛匦预蜃钸m化チェビシェフフィルタ?   通^域を咨にして遮断周波数g位：  dBについてデシベル( dB )とは?   gに比のを数で表Fしたもの?   例：エアコン30dB以下のX音レベル? 基室Rからのエネルギ`が30dB以下だということ算方法?   dB = 20 log 10(E2/E1)  ＜E1, E2は振幅をさす＞?   dB = 10 log 10(P2/P1)  ＜P1,P2はパワ`をさす＞? 意味はE1(P1)にするE2,P2の利得をさす?   例：振幅が 1 /   2になるということは近xでのp衰A度を重? E1=1とするとE2= 1/2 なので  20 log ( 1 /   2)を算すると? 通^域にリプル (うねり) を持たせて急峻なp衰特性をgF答えはC3、よって、3dBp衰となる。4演n}(4/5)システムに振幅1の信号を入力すると出力 では振幅が100になった。このシステムの 利得(dB)はいくつか？演n}(4/5) 解答例システムに振幅1の信号を入力すると出力では振幅が100になった。 このシステムの利得(dB)はいくつか？振幅1                                    振幅100システム振幅1                         振幅100システムヒント：   dB = 20 log10 (E2/E1) に を代入して算するだけ利得dB = 20 log10(E2/E1)= 20 log10(100/1)= 20 log  (102 )= 20 ?  2= 40Ans.  40 dBCMなどで出てくるdBのめやすすべて基室Rレベルからの比をさす10dB     ---                           70dB      のベル20dB    置rの秒の音      80dB      の中30dB    郊外の深夜                90dB      X々しい工訾40dB    市内の深夜?^    100dB    高架ガ`ド下50dB    静かな事账             110dB    自榆の警笛60dB    静かな\用             120dB    w行Cエンジンの近く演n}(5/5)音Rレベルが60dBのu品がある。このu 品は基室Rと比^して、何倍の振幅 と何倍のパワ`を持つか算せよ。ヒント：振幅はdB = 20 log10 (E2/E1) に を代入してE2/E1を求めればよい。 パワ`はdB = 10 log10 (P2/P1) に を代入してP2/P1を求めればよい。演n}(5/5) 解答例音Rレベルが60dBのu品がある。このu品は基室Rと比^して、何倍の振幅 と何倍のパワ`を持つか算せよ。?   振幅?   dB = 20 log 10 (E2/E1)、  db = 60を代入すると?   60 = 20 log 10 (E2/E1)?   log10  (E2/E1) = 3?   E2/E1 = 10   = 1000    Ans. 1000倍の振幅を持つ?   パワ`?   dB = 10 log 10 (P2/P1)、  db = 60を代入すると?   60 = 10 log 10 (P2/P1)?   log10  (P2/P1) = 6?   P2/P1 = 10   = 1000000  Ans. 100万倍のパワ`を持つ5デジタル信号I理第１１回vxY料 （デジタルフィルタのO）立命^大学 情罄砉ぱР  メディア情笱Э 李  亮２０１６．９．２９本日のvx内容【土】前々回vxの土?  デジタルフィルタ? デジタルフィルタとはデジタルフィルタのO?  デジタルフィルタのO?  デジタルフィルタの市造?  デジタルフィルタのOアルゴリズム【土】デジタルフィルタフィルタとは?   々なものの中から、不要なものを除去して必要なもの を取り出す回路?   例：叱Cやエアコンのフィルタ? これらはアナログフィルタ【土】 デジタルフィルタの基本特性デジタルフィルタのNは４Nに分デジタルフィルタとは?   色々な周波数成分を持つ信号の中から、不要な周波数 成分を除去し、必要な周波数成分のみを取り出す回路低域通^フィルタ高域通^フィルタ∮蛲ㄟ^フィルタ∮蜃柚攻榨％毳?   例：ステレオのドルビ`C能? j音を抑Rしたり、音を{したりするC能(low pass filter:LPF)(high pass filter:HPF)  (band pass filter:BPF) (band stop filter:BSF)【土】 低域通^フィルタのO理想的な低域通^フィルタ?   低域だけをきれいに取り出す?   高域の利得はゼロ? ?  非常にOがyしい一般的な低域通^フィルタ?   遮断周波数で完全に利得を ゼロにできない?   用途に合わせて々な低域通^ フィルタのO方法があるGain通^域         p衰域遮断周波数【土】 低域通^フィルタのNと特性バタワ`スフィルタ?   通^域をフラットにすることを重? 一般的なフィルタベッセルフィルタ?   立ち上がり特性を最mにする? ^渡甏鹛匦预蜃钸m化チェビシェフフィルタ?   通^域を咨にして遮断周波数 近xでのp衰A度を重? 通^域にリプル (うねり) を持たせて 急峻なp衰特性をgF1【土】g位：  dBについてデシベル( dB )とは?   gに比のを数で表Fしたもの?   例：エアコン30dB以下のX音レベル? 基室Rからのエネルギ`が30dB以下だということ系の市造（１）デジタルフィルタの造はブロック恧 よって表すのが实倪W延器算方法?   dB = 20 log 10(E2/E1)  ＜E1, E2は振幅をさす＞?   dB = 10 log 10(P2/P1)  ＜P1,P2はパワ`をさす＞? 意味はE1(P1)にするE2,P2の利得をさすx(n)x(n)x(n-1)y(n)z(n) =x(n) + y(n)信号を1点だけW延させる素子を表しW延-1を示すDやZQの表を用いてZ  と表す加算器2つの信号にして和を出力する素子。p 算を行う龊悉鲜赣〔糠证朔号の－号 を付け加える。?   例：振幅が 1 /   2になるということは? E1=1とするとE2= 1/2 なので  20 log ( 1 /   2)を算すると\算器答えはC3、よって、3dBp衰となる。x(n)y(n) =a ?x(n)入力を定数倍(a)して出力する素子。差分方程式がわからない学生は、 数学の教科にて土しておくこと系の市造（２）系の市造（３）デジタルフィルタの市造?  差分方程式はM                                         Ny(n) ? ? ak x(n ? k ) ? ? bk y(n ? k )k ?0k ?1?  ｚQするとM                                              N? i                                    ? iY ( z) ? ?a z ?i ? X ( z) ? ?b z ?i ?Y ( z)入出力vS（差分方程式）は下のように表せる? i ?0               ?? i ?1               ?M                                       Ny(n) ? ? ak x(n ? k ) ? ? bk y(n ? k )k ?0k ?1系の市造（４）デジタルフィルタの市造演n}（1/4）次のブロック恧鞘兢丹欷毳钎弗骏毳榨％毳郡稳 力と出力のvSを式で表し、贿_v数を求めよ。?      N                 ?? M                 ??1 ? ? b z ?i ?Y ( z) ? ? ? a z ?i ? X ( z)a0               ai?     i ?1               ?Mi? i ?0                ?x      x＋             z ?11yz ?1                                 ＋Y ( z) ? X ( z)? a z ?ii ?0N1 ? ? b z ?ii ?1? b1           ?ヒント：差分方程式を良く y(n)b2Ma x(na2Nk )        b y(n   k )贿_v数（インパルス甏穑┮て考えるように? ? kk ?0?    ? ? k            ?k ?12演n}（1/4）  大ヒントa0               a1演n}（1/4）  解答例（１）差分方程式は2                                           2x      x                                         yy(n) ? ? ak x(n ? k ) ? ? bk y(n ? k )＋   0          z ?1? b1z ?1                                 ＋a2? b2ZQするとk ?0? 2?i ?k ?1? 2?i ?Y ( z) ? ? ? ai z?X ( z) ? ? ? bi z?Y ( z)? i ?0              ?? i ?1               ?y(n) ? ? ak x(n ? k ) ? ? bk y(n ? k )湫韦工毪k ?0k ?1?          2                 ?? 2                 ?ブロック恧瑜M=２、N＝２．? 1 +  ? b z ?i   ? Y ( z) ? ? ? a z ?i  ?X ( z)よって贿_v数は？i?         i ?1               ?i? i ?0              ?演n}（1/4）  解答例（２）よって贿_v数は演n}（2/4）?          2                 ?? 2                 ?贿_v数が? 1 +  ? b z ?i   ? Y ( z) ? ? ? a z ?iX ( z)z 2 ? z ? 1i?         i ?1               ?2i          ?? i ?0              ?G( z) ?z 2 ? 0.2z ? 0.48Y ( z)   ?X ( z)? a z ?ii ?021 ? ? b z ?iで与えられるデジタルフィルタを市 造でブロックY恧成し硎兢护琛i ?1?1                  ?2?     a0   ? a1 z    ? a2  z           1  ? b1 z   ?b2 zヒント：分子分母を z2  で割るとどうなるか？演n}（2/4）  大ヒント贿_v数演n}（2/4）  解答例(1)?1          ?2            2                            G( z) ?      1 ? z    ? z         G( z) ?z  ? z ? 11 ? 0.2z ?1 ? 0.48z ?2をZ2 でわると、G( z) ?z 2 ? 0.2 z ? 0.481 ? z ?1 ? z ?2?                         ?と２次の市造の贿_v数（演n}(1/4)の解答例など）を比させると1 ? 0.2z 1 ? 0.48z  2?1                  ?2?     a0   ? a1 z    ? a2  z           この式を２次の市造にあてはめると、、、1  ? b1z ?1 ?b  z ?2よってa0  = 1, a1 = 1, a2 = 1, b1 = 0.2, b2 = -0.483演n}（2/4）  解答例(2)デジタルフィルタの市造a0 = 1, a1 = 1, a2 = 1, b1 = 0.2, b2 = -0.48デジタルフィルタの市造1.01.0?    bi  ? 0 のとき、非再⑿庭钎％弗骏毳榨％毳? インパルス甏黏有限rgでK了? FIRディジタルフィルタx                                                 y＋             z ?1-(0.2)z ?1＋1.0?    bi  ? 0 のとき、再⑿庭钎弗骏毳榨％毳? インパルス甏黏o限に@A? IIRディジタルフィルタ-(-0.48)?  FIR, IIRフィルタについては次Lしくh明高域通^フィルタのOアルゴリズム低域通^フィルタがOできれば、高域通^∮蛲ㄟ^フィルタのOアルゴリズムフィルタもO可能。?  目的の遮断周波数を  ? H とする。GL ( z)?       GH ( z)?      GBP ( z)(1)? L  ? 1 ? ? H として、低域フィルタの贿_v数?   ?GL ( z)を出す。(2) GH ( z) ? GL (? z) を求めることで高域通^フィ ルタをO可能X ( z)?LGL ( z)?HGH ( z)L        HY ( z)∮蜃柚攻榨％毳郡卧Oアルゴリズム演n}（3/4）贿_v数がGL ( z)?        GH ( z)?      GBS ( z)G( z) ?z 2 ? 2 z ? 1z 2 ? 0.2z ? 0.48?LX ( z)?HGL ( z)＋GH ( z)?L   ?HY ( z)で与えられる２次デジタルフィルタを１次の kA接A造でブロック恧颏け。ヒント：  １次のkA接A造ということは∮蛲ㄟ^フィルタ の形（２の欷彼悖─湫韦工欷OK4演n}（3/4）  大ヒント贿_v数演n}（3/4） 解答例贿_v数が２の欷彼悚潜恧护     z 2  ? 2 z ? 1   G( z) ?G( z) ?1 ? z -11 ? z- 1z 2 ? 0.2z ? 0.481 ? 0.6z ?11 ? 0.8z ?1をZ2 でわると、ので、kA接A造のブロック恧G( z) ?1 ? 2 z ?1 ? z ?2?                        ?1.01.01 ? 0.2 z 1 ? 0.48z  2                                                                            x                                                        y２の欷彼悚涡韦湫韦工毪取1 ? z ?11 ? z ?1＋        z ?1＋     ＋1.0z ?1＋1.0?1 ? 0.6z ?1×1 ? 0.8z ?1-(-0.6)-(0.8)∮蛲ㄟ^フィルタの基本造となる演n}（4/4）贿_v数が2演n}（4/4）  大ヒント贿_v数2G( z) ? 2z? 1.2 z ? 0.6G( z) ?  2z  ? 1.2 z ? 0.6z 2 ? 0.2z ? 0.48で与えられる２次デジタルフィルタを１次のをZ2 でわると、z 2 ? 0.2z ? 0.48?1                   ?2K列接A造でブロック恧颏け。G( z) ?2 ? 1.2 z? 0.6 z1 ? 0.2 z ?1 ? 0.48z ?2２のたし算の形に湫韦工毪取ヒント：  １次のK列接A造ということは∮蜃柚攻榨％毳 の形（２の足し算）に湫韦工欷OK?       1       ?1 ? 0.6z ?11 ? z ?11 ? 0.8z ?1演n}（4/4） 解答例贿_v数が２のたし算で表せる?1G( z) ?11 ? 0.6 z ?1?   1 ? z1 ? 0.8z ?1ので、K列接A造のブロック恧1.0＋        z ?1x1.0＋-(-0.6)＋        z ?1＋1.0∮蜃柚攻榨％毳郡位本造となる-(0.8)5デジタル信号I理第１２回vxY料（フィルタの安定性と造）立命^大学 情罄砉ぱР  メディア情笱Э 李  亮２０１６．９．３０本日のvx内容【土】前回vxの土?   デジタルフィルタのO? デジタルフィルタのO? デジタルフィルタの市造? デジタルフィルタのOアルゴリズムフィルタの安定性と造? フィルタの安定性について? FIRフィルタ?IIRフィルタとは相vv数? 自己相vと相互相v【土】系の市造（１）デジタルフィルタの造はブロック恧 よって表すのが实摹土】系の市造（２）x(n)x(n)x(n-1)y(n)z(n) =x(n) + y(n)W延器 信号を1点だけW延させる素子を表しW延 を示すDやZQの表を用いてZ-1   と表 す加算器2つの信号にして和を出力する素子。p 算を行う龊悉鲜赣〔糠证朔号の－号 を付け加える。入出力vS（差分方程式）は下のように表せる\算器                                                                                                     M                                       Nx(n)y(n) =a ?x(n)入力を定数倍(a)して出力する素子。y(n) ? ? ak x(n ? k ) ? ? bk y(n ? k )k ?0k ?1【土】系の市造（３）ディジタルフィルタの市造?  差分方程式は【土】系の市造（４）ディジタルフィルタの市造M                                         N                                                                                                ?      N?i ?? M            ?i ?y(n) ? ? ak x(n ? k ) ? ? bk y(n ? k )?1 ? ? bi z?Y ( z) ? ? ? ai z? X ( z)k ?0k ?1?     i ?1?           ? i ?0                ?M?  ｚQすると? a z ?iM                                              N? i                                    ? iY ( z) ? X ( z)i ?0?iY ( z) ? ?a z ?i ? X ( z) ? ?b z ?i ?Y ( z)                                                           N? i ?0               ?? i ?1               ?1 ? ? bi zi ?1贿_v数（インパルス甏穑1フィルタの安定性について（１）安定なフィルタとは?   贿_v数（インパルス甏穑─束すること。?   束しない龊悉喜话捕à圣榨％毳郡榷xされる。系が安定であるための必要十分条件は、フィルタの安定性について（２）Oとは?  贿_v数G(z)?  とする。ここでz = -aのときz j                 z j   ? 1?   贿_v数のO    が全て             である。? 贿_v数の分母が0、フィルタの利得が∞このようなｚをO(pole)と呼ぶ?   すなわち、O zある。j  が ｚ 平面において全てg位夷冥??  このOが z? 1 を氦郡护邪捕à趣胜辍氦郡丹胜堡欷胁话捕à趣胜搿Ｑ萘n}（1/5）差分方程式がy(n) ? x(n) ? x(n ? 1)?1.5 y(n ? 1) ? y(n ? 2)であるフィルタの安定性を{べよ。演n}（1/5） ヒント差分方程式：y(n) ? x(n) ? x(n ?1)? 1.5 y(n ? 1) ? y(n ? 2)贿_v数：y(n) ? 1.5 y(n ?1) ? y(n ? 2) ? x(n) ? x(n ?1) (1 ? 1.5z ?1 ? z ? 2 )Y ( z) ? (1 ? z ?1 ) X ( z)ヒント：  贿_v数を求めて、Oを{べれば、、、G( z) ?1 ? z ?11 ? 1.5z ?1 ? z ? 2?     0.61 ? 0.5z ?1?    0.41 ? 2 z ?1演n}（1/5） 解答例差分方程式：y(n) ? x(n) ? x(n ? 1)? 1.5 y(n ? 1) ? y(n ? 2)演n}（2/5）差分方程式がy(n) ? x(n) ? y(n ? 1) ? 0.5 y(n ? 2)贿_v数：y(n) ? 1.5 y(n ?1) ? y(n ? 2) ? x(n) ? x(n ?1)(1 ? 1.5z ?1 ? z ? 2 )Y ( z) ? (1 ? z ?1 ) X ( z)であるフィルタの安定性を{べよ。G( z) ?1 ? z ?11 ? 1.5z ?1 ? z ? 2?     0.61 ? 0.5z ?1?    0.41 ? 2 z ?1Oは  z = 0.5, -2ある１つのOが z? 1を氦郡丹胜い韦遣话捕ē谣螗龋  贿_v数を求めて、Oを{べれば、、、2演n}（2/5） ヒント差分方程式：y(n) ? x(n) ? y(n ?1) ? 0.5 y(n ? 2)演n}（2/5） 解答例差分方程式：y(n) ? x(n) ? y(n ? 1) ? 0.5 y(n ? 2)贿_v数：贿_v数：y(n) ? y(n ?1) ? 0.5 y(n ? 2) ? x(n)G( z) ??1 ? z ?11? 0.5z ?2z 2(1 ? z ?1 ? 0.5z ? 2 )Y ( z) ? X ( z)( z ? (0.5 ? 0.5 j))( z ? (0.5 ? 0.5 j))G( z) ??11 ? z ?1 ? 0.5z ? 2z 2Oは  z = (0.5+0.5j), (0.5-0.5j)( z ? (0.5 ? 0.5 j))( z ? (0.5 ? 0.5 j))すべてのOが z? 1を氦郡工韦前捕ā土】 デジタルフィルタの市造ディジタルフィルタの市造FIRフィルタFIRフィルタとは?   Finite Impulse Response Filter の略?   インパルス甏黏有限のrgでK了するフィルタ?    bi  ? 0 のとき、非再⑿庭钎％弗骏毳榨％毳? インパルス甏黏有限rgでK了? FIRディジタルフィルタ?    bi  ? 0 のとき、再⑿庭钎％弗骏毳榨％毳? インパルス甏黏o限に@A? IIRディジタルフィルタ?   非再⒉郡韦撙成されるi ?1?   贿_v数はG ( z) ?M?i ?0ai zFIRフィルタの特FIRフィルタの特?  常に安定なフィルタ?  完全形位相（直位相）のgFが容易? 周波数にvSなく音のW延（位相推移）が一定? 例えば、空葜肖1秒gに10Hzの音は340mMむが、1kHzの音も340mMむので直位相。?  高次の次数が必要? 特性の良いフィルタをOするためには次数（z-a ）を 大きく取る必要がある。IIRフィルタIIRフィルタとは?   Infinite Impulse Response Filter の略?   インパルス甏黏o限Lのフィルタ?   再⒉郡确窃⒉郡成されるi ?1M?  gHにOするのは比^的gだが、特性の良?   贿_v数はG( z) ?? ai zi ?0Nいフィルタを作ることはyしい。1 ? ? b z ?ii ?13IIRフィルタの特IIRフィルタの特?   安定性は保^されない?   位相特性はひずむ? 特定周波数のみ音のW延（位相推移）がおこる可能性あり? 例えば、10Hzの音はIIRフィルタに通すと１秒Wれるのにして、1kHzの音をIIRフィルタに通しても、Wれは１秒とは限らない。?   低次の次数で十分? FIRフィルタと比^して特性の良いフィルタ（急峻な特性を持つフィ ルタ）を低次の次数でO可能?   例えばFIRで100次必要なフィルタがIIRなら10次程度でgF可能?   しかしgHに安定かつ高性能なIIRフィルタをOするこ とは非常に困y。演n}（3/5）５点の移悠骄を求めるFIRフィルタを 市造を用いてOせよ。?  ヒント：例えば３点の移悠骄を考える。? 信号ｘ(n)のr刻ｎにおける３点の移悠骄は、?  y(n) = ( x(n) + x(n-1) + x(n-2) )/3と表せる。?  ５点の移悠骄だと？?  さらにz表で表すと？?  贿_v数は？?  市造は？演n}（3/5）  大ヒント５点の移悠骄を求めるFIRフィルタを市造を 用いてOせよ。?   ヒント：例えば３点の移悠骄を考える。? 信号ｘ(n)のr刻ｎにおける３点の移悠骄は、?   y(n) = ( x(n) + x(n-1) + x(n-2) )/3と表せる。?   ５点の移悠骄だと?   y(n) = ( x(n) + x(n-1) + x(n-2) + x(n-3) + x(n-4) )/5?   さらにz表で表すと?   Y(z) =  (X(z) + X(z)z-1   + X(z)z-2  + X(z)z-3 + X(z)z-4  ) / 5?   贿_v数は演n}（3/5）  解答例５点の移悠骄を求めるFIRフィルタを市 造を用いてOせよ。?  贿_v数? Y(z)/X(z) = (1 + z-1   + z-2    + z-3    + z-4    ) / 5=                =-1         -2           -3         -4?   Y(z)/X(z) = (1 + z   + z   + z   + z   ) / 5?   市造は？フィルタのまとめデジタルフィルタ?   色々な周波数成分を持つ信号の中から、不要な周波 数成分を除去し、必要な周波数成分のみを取り出す 回路?   あらゆる系はデジタルフィルタにより表F可能?   デジタルフィルタのO? FIRフィルタのOは比^的容易だが、急峻な特性をgFす ることは困y? IIRフィルタは非常に急峻な特性をgFできるが、gHのO は非常に困y?   信号I理の基本はフィルタO? 信号I理の精度/性能はフィルタの性能/Oに大きく依存相vv数相vv数とは?  ２つの信号がどの程度似ているのかを定量的に 表す１つの尺度? 信号の食訾潆j音除去などに良く使われる?  相互相vv数?  自己相vv数4相互相vv数信号ｘと信号ｙがどのくらい似ているかを定量的 に表したもの?   ２つの信号が完全に一致する龊稀⑾嚅vS数は最大 となる。まったく一致しない龊悉膝讥怼Ｗ约合嚅vv数同じ信号gの相互相v?   ２つの信号が完全に一致する龊稀⑾嚅vS数は最大 となる。まったく一致しない龊悉膝讥怼Ｏ嚅vv数の考え方数学の内eと同じ?   たとえばベクトルAとベクトルBの内eは?            は２つのベクトルのなす角を表し、? ２つのベクトルの向きが一致すると          となり内eは最大? お互いが直交vSにあると、内eはゼロ。?   この考え方を信号に暧盲筏郡猡韦相vv数。? ２つの信号が似ている（向きが一致）と相vは最大? お互いがまったく似ていない（直交vSにある）と相vはゼロ。演n}（4/5）,                , N = ８としたとき の相互相vv数を算し、横Sをkの、k Sを相互相vとして硎兢护琛￥蓼肯嗷ハ嚅vv数はどのような事象を{べる ときに役立つか考えよ。? ヒント：                                  にを代入して算する だけ。sin,cosv数の特性が良くわかっていれば最後まで 算しなくても硎究赡堋Ｑ萘n}（4/5）  解答例（１）,                , N = ８としたときの 相互相vv数を算し、横Sをkの、kSを 相互相vとして硎兢护琛Rxy(0) = 1/8 ?｛sin(π?0/4)cos  (π?(0+0)/4)  + sin(π?1/4)cos  (π?(1+0)/4)  + sin(π?2/4)cos  (π?(2+0)/4) + sin(π?3/4)cos  (π?(3+0)/4)  + sin(π?4/4)cos (π?(4+0)/4)  + sin(π?5/4)cos (π?(5+0)/4)  + sin(π?6/4)cos (π?(6+0)/4)  + sin(π?7/4)cos (π?(7+0)/4)  ｝=  1/8 ｛  0?1 + (1/√2)?(1/√2)  + 1?0 + (1/√2) ?(-1/√2) +0?(-1) + (-1/√2) ?(-1/√2) + (-1)?0 + (-1/√2) ?(1/√2) }=  0演n}（4/5）  解答例（2）Rxy(1) = 1/8 ?｛sin(π?0/4)cos (π?(0+1)/4) + sin(π?1/4)cos (π?(1+1)/4) + sin(π?2/4)cos (π?(2+1)/4) + sin(π?3/4)cos (π?(3+1)/4) + sin(π?4/4)cos (π?(4+1)/4) + sin(π?5/4)cos (π?(5+1)/4) + sin(π?6/4)cos (π?(6+1)/4) + sin(π?7/4)cos (π?(7+1)/4) ｝=  1/8 ｛  0? (1/√2) + (1/√2)?0 + 1?(-1/√2) + (1/√2)?(-1) +0?(-1/√2) + (-1/√2)?0 + (-1)?(1/√2) + (-1/√2)?1 }=  -1/2√2 P -0.35Rxy(2) = 1/8 ?｛sin(π?0/4)cos (π?(0+2)/4) + sin(π?1/4)cos (π?(1+2)/4) + sin(π?2/4)cos (π?(2+2)/4) + sin(π?3/4)cos (π?(3+2)/4) + sin(π?4/4)cos (π?(4+2)/4) + sin(π?5/4)cos (π?(5+2)/4) + sin(π?6/4)cos (π?(6+2)/4) + sin(π?7/4)cos (π?(7+2)/4) ｝=  1/8 ｛  0?0 + (1/√2)?(-1/√2) + 1?(-1) + (1/√2)?(-1/√2) +0?0 + (-1/√2)? (1/√2) + (-1)?1+ (-1/√2)?(1/√2) }=  -1/2 = -0.55演n}（4/5）  解答例（3）Rxy(0) ＝ 0                   Rxy(1) ＝ -1/2√2 P -0.35Rxy(2) ＝ -0.5               Rxy(3) ＝ -1/2√2 P -0.35Rxy(4) ＝ 0                   Rxy(5) ＝ 1/2√2 P 0.35Rxy(6) ＝ 0.5                Rxy(7) ＝ 1/2√2 P 0.35演n}(4/5) 解答例（4）また相互相vv数はどのような事象を{べると きに役立つか考えよ。?   信号ｘと信号ｙがどのくらい似ているかを定量的に表し たものなので、? 例えば、? h音した会の中から、特定の人の声が含まれているかどう かの{? Webの情仕鳏胜嗓恰⒏鳐讴`ジがどのくらいキ`ワ`ドの 情螭蚝むかを{べたりするのに有垦萘n}（5/5）, N = ８としたときの自己相v v数を算し、横Sをkの、kSを自己相 vとして硎兢护琛￥蓼孔约合嚅vv数はどのような事象を{べる ときに役立つか考えよ。? ヒント：                                  にを代入して算する だけ。sinv数の特性が良くわかっていれば最後まで算 しなくても硎究赡堋Ｑ萘n}（5/5）  解答例（１）, N = ８としたときの自己相vv 数を算し、横Sをkの、kSを自己相v として硎兢护琛Rxx(0) = 1/8 ?｛sin(π?0/4)sin(π?(0+0)/4) + sin(π?1/4)sin(π?(1+0)/4) + sin(π?2/4)sin(π?(2+0)/4) + sin(π?3/4)sin(π?(3+0)/4) + sin(π?4/4)sin(π?(4+0)/4) + sin(π?5/4)sin(π?(5+0)/4) + sin(π?6/4)sin(π?(6+0)/4) + sin(π?7/4)sin(π?(7+0)/4) ｝=  1/8 ｛  0?0 + (1/√2)?(1/√2) + 1?1 + (1/√2) ?(1/√2) +0?0 + (-1/√2) ?(-1/√2) + (-1)?(-1) + (-1/√2) ?(-1/√2) }=  0.5演n}（5/5）  解答例（2）Rxx(1) = 1/8 ?｛sin(π?0/4)sin(π?(0+1)/4)  + sin(π?1/4)sin(π?(1+1)/4)  + sin(π?2/4)sin(π?(2+1)/4)  + sin(π?3/4)sin(π?(3+1)/4)  + sin(π?4/4)sin(π?(4+1)/4)  + sin(π?5/4)sin(π?(5+1)/4)  + sin(π?6/4)sin(π?(6+1)/4)  + sin(π?7/4)sin(π?(7+1)/4)  ｝=  1/8 ｛  0?(1/√2) + (1/√2)?1 + 1?(1/√2) + (1/√2)?0 +0?(-1/√2) + (-1/√2)?(-1) + (-1)? (-1/√2) + (-1/√2) ?0 }=  1/2√2 P 0.35Rxx(2) = 1/8 ?｛sin(π?0/4)sin(π?(0+2)/4)  + sin(π?1/4)sin(π?(1+2)/4)  + sin(π?2/4)sin(π?(2+2)/4)  + sin(π?3/4)sin(π?(3+2)/4)  + sin(π?4/4)sin(π?(4+2)/4)  + sin(π?5/4)sin(π?(5+2)/4)  + sin(π?6/4)sin(π?(6+2)/4)  + sin(π?7/4)sin(π?(7+2)/4)  ｝=  1/8 ｛  0?1 + (1/√2)?(1/√2) + 1?0 + (1/√2) ? (-1/√2) +0?(-1) + (-1/√2)?(-1/√2) + (-1)?0 + (-1/√2) ? (1/√2) }演n}（5/5）  解答例（3）Rxx(0) ＝ 0.5                Rxx(1) ＝ 1/2√2 P 0.35Rxx(2) ＝ 0                   Rxx(3) ＝ -1/2√2 P -0.35Rxx(4) ＝ -0.5               Rxx(5) ＝ -1/2√2 P -0.35Rxx(6) ＝ 0                   Rxx(7) ＝ 1/2√2 P 0.35=  06演n}(5/5) 解答例（4）また自己相vv数はどのような事象を{べるときに 役立つか考えよ。?   自分自身がどのくらい似ているかを定量的に表したもの なので、Rり返しの周期を食訾工毪瑜Δ胜猡稳般に有 ? 例えば、? テレビの映像の中でCMのタイミングを食訾筏郡辘工毪韦擞? 株の婴庾约合嚅vv数とその周期から予yすることもある7
